      **************************************************************/   EFIX2314
      *  PROGRAM: PPNETCLC                                         */   EFIX2314
      *  RELEASE: ___2314______ SERVICE REQUEST(S): _RITM0186534_  */   EFIX2314
      *  NAME:______TAYAG______ MODIFICATION DATE:  ___01/23/18__  */   EFIX2314
      *  DESCRIPTION:                                              */   EFIX2314
      *  - FIX CODE ISSUE IN R2237 THAT ADDRESSED RITM0117368.     */   EFIX2314
      *    PROBLEM IS THAT DEDUCTION WAS BEING TAKEN EVEN IF       */   EFIX2314
      *    EMPLOYEE HAS SWITCHED OUT OF THE HIGH DEDUCTIBLE PLAN   */   EFIX2314
      *    AND THE CHECK DATE WAS BEYOND THE COVERAGE END DATE.    */   EFIX2314
      **************************************************************/   EFIX2314
      **************************************************************/   13872234
      *  PROGRAM: PPNETCLC                                         */   13872234
      *  RELEASE: ___2234______ SERVICE REQUEST(S): ___101387____  */   13872234
      *  NAME:__MAXINE GERBER__ MODIFICATION DATE:  ___06/20/16__  */   13872234
      *  DESCRIPTION:                                              */   13872234
      *   2017 DISABILITY PLAN PROJECT                             */   13872234
      *    ADDED CODE FOR 2017 DISABILITY SHORT AND LONG-TERM      */   13872234
      *    PLANS. CALL PPBENDIS TO OBTAIN RATES AND PREMIUMS.      */   13872234
      *    DID NOT REMOVE CODE FOR THE OLD PLANS. THIS SHOULD      */   13872234
      *    BE DONE IN A LATER PHASE.                               */   13872234
      **************************************************************/   13872234
      **************************************************************/   14372237
      *  PROGRAM: PPNETCLC                                         */   14372237
      *  RELEASE: ___2237______ SERVICE REQUEST(S): ___101437____  */   14372237
      *  RELEASE: ___2237______ SERVICE REQUEST(S): _RITM0117368_  */   EFIX2237
      *  NAME:______TAYAG______ MODIFICATION DATE:  ___08/08/16__  */   14372237
      *  DESCRIPTION:                                              */   14372237
      *  - CHANGE THE HEALTH PLAN CODE ASSOCIATED WITH HSA FROM    */   14372237
      *    'SP' TO 'AP'.                                           */   14372237
      *  - TAKE HSA DEDUCTION WHEN EMPLOYEE HAS SWITCHED OUT OF    */   EFIX2237
      *    HIGH DEDUCTIBLE PLAN IF CHECK DATE IS STILL BETWEEN     */   EFIX2237
      *    COVERAGE EFF DATE AND COVERAGE END DATE.                */   EFIX2237
      **************************************************************/   14372237
      **************************************************************/   12082230
      *  PROGRAM: PPNETCLC                                         */   12082230
      *  RELEASE: ___2230______ SERVICE REQUEST(S): ____101208___  */   12082230
      *  NAME:__MAXINE GERBER__ MODIFICATION DATE:  ___02/23/16__  */   12082230
      *  DESCRIPTION:                                              */   12082230
      *  - FOR NEW CALC ROUTINE 32, CALL PPBENR16 TO CACULATE      */   12082230
      *    THE TIER 2016 DEDUCTION AND CONTRIBUTION AMOUNTS        */   12082230
      **************************************************************/   12082230
      **************************************************************/   02312089
      *  PROGRAM: PPNETCLC                                         */   02312089
      *  RELEASE: ___2089______ SERVICE REQUEST(S): ___100231____  */   02312089
      *  NAME:_______NXB_______ MODIFICATION DATE:  ___12/18/13__  */   02312089
      *  DESCRIPTION:                                              */   02312089
      *  -Establish a new special calculation process              */   02312089
      *   6000-HSA-CALC                                            */   02312089
      **************************************************************/   02312089
      **************************************************************/   39362090
      *  PROGRAM: PPNETCLC                                         */   39362090
      *  RELEASE: ___2090______ SERVICE REQUEST(S): ____83936____  */   39362090
      *  NAME:______RIDER______ MODIFICATION DATE:  ___09/13/13__  */   39362090
      *  DESCRIPTION:                                              */   39362090
      *  - FSS SUBJECT GROSSES ARE LIMITED ONLY BY FSS GROSSES     */   39362090
      *  (LIMIT IS 25% OF THE COVERED COMP LIMIT)                  */   39362090
      *  - SAFE HARBOR SUBJECT GROSSES ARE LIMITED ONLY BY SAFE    */   39362090
      *  HARBOR GROSSES (LIMIT IS THE COVERED COMP LIMIT)          */   39362090
      *  - UCRP IS NOT LIMITED FURTHER BY FSS OR SAFE HARBOR       */   39362090
      *  GROSSES (LIMIT IS THE COVERED COMP LIMIT, SET BY PPGRSPAR */   39362090
      *  BUT ADJUSTED HERE FOR INTERACTIONS WITH NON-CURRENT       */   39362090
      *  ACTIVITY SUCH AS RUSH CHECKS)                             */   39362090
      **************************************************************/   39362090
      **************************************************************/   36362075
      *  PROGRAM: PPNETCLC                                         */   36362075
      *  RELEASE: ___2075______ SERVICE REQUEST(S): ____83636____  */   36362075
      *  NAME:_______MSM_______ MODIFICATION DATE:  ___11/20/12__  */   36362075
      *  DESCRIPTION:                                              */   36362075
      *  -To support new Post Employment Benefit Tier Rate, add    */   36362075
      *  values of 'W' and '6' FOR EVALUATE RET-ELIG-CODE and      */   36362075
      *  CHECK FOR RET-ELIG-CODE  = 'U' or 'W'                     */   36362075
      **************************************************************/   36362075
      **************************************************************/   EFIX1998
      *  PROGRAM: PPNETCLC                                         */   EFIX1998
      *  RELEASE: ___1998______ ERROR REPORT(S):    ____2412_____  */   EFIX1998
      *  NAME:_BASKAR CHITRAVEL MODIFICATION DATE:  ___10/21/11__  */   EFIX1998
      *  DESCRIPTION:                                              */   EFIX1998
      *  - Move 1 to day and add 1 to month in the calculation of  */   EFIX1998
      *    KCOV-EFFECTIVE-DATE-1 before calling PPCOVRGE program   */   EFIX1998
      *    for CA, CA-SDDP, and FEDERAL modes.                     */   EFIX1998
      **************************************************************/   EFIX1998
      **************************************************************/   30001947
      *  PROGRAM: PPNETCLC                                         */   30001947
      *  RELEASE: ___1947______ SERVICE REQUEST(S): ____82551____  */   25511947
      *                         SERVICE REQUEST(S): ____83000____  */   30001947
      *  NAME:______RIDER______ MODIFICATION DATE:  ___11/04/10__  */   25511947
      *  DESCRIPTION:                                              */   25511947
      *  - ALLOW FOR NEGATIVE SAFE HARBOR REDUCTIONS.              */   25511947
      *  - CALL PPCOVRGE TO RE-EVALUATE WOD COVERAGE, BASED ON     */   30001947
      *    CHECK DATE AND IMPUTED INCOME TYPE (FEDERAL AND         */   30001947
      *    CALIFORNIA).                                            */   30001947
      **************************************************************/   30001947
      **************************************************************/   17451757
      *  PROGRAM: PPNETCLC                                         */   17451757
      *  RELEASE: ___1757______ SERVICE REQUEST(S): ____81745____  */   17451757
      *  NAME:______RIDER______ MODIFICATION DATE:  ___03/05/07__  */   17451757
      *  DESCRIPTION:                                              */   17451757
      *  - ADD EBEUC AND EBERC TO THE UCR INTERFACE.               */   17451757
      **************************************************************/   17451757
      **************************************************************/   15401735
      *  PROGRAM: PPNETCLC                                         */   15401735
      *  RELEASE: ___1735______ SERVICE REQUEST(S): ____81540____  */   15401735
      *  NAME:_______QUAN______ MODIFICATION DATE:  ___09/12/06__  */   15401735
      *  DESCRIPTION:                                              */   15401735
      *  - Moved KNET-EMP-BEN-ELIG-UNIT-CD and KNET-EMP-BEN-ELIG-  */   15401735
      *    Representation Code to medical rate lookup key.         */   15401735
      *  - Removed the logic that increment the month from the     */   15401735
      *    Pay Period End date by 1 and year by 1 if necessary;    */   15401735
      *    that logic has been moved to the medical rate lookup    */   15401735
      *    utility module PPBENXHI.                                */   15401735
      *  - Suppressed message 40-111 for medical only.             */   15401735
      **************************************************************/   15401735
      **************************************************************/   15611721
      *  PROGRAM: PPNETCLC                                         */   15611721
      *  RELEASE: ___1721______ SERVICE REQUEST(S): ____81561____  */   15611721
      *  NAME:______GLASER_____ MODIFICATION DATE:  ___08/16/06__  */   15611721
      *  DESCRIPTION:                                              */   15611721
      *  in 2200-FWT-CALC, added stmt to move primay pay cycle     */   15611721
      *  from KNET area to the KFED area before call to PPFEDTAX.  */   15611721
      **************************************************************/   15611721
      **************************************************************/   15121716
      *  PROGRAM: PPNETCLC                                         */   15121716
      *  RELEASE: ___1716______ SERVICE REQUEST(S): ____81512____  */   15121716
      *  NAME:_______QUAN______ MODIFICATION DATE:  ___08/02/06__  */   15121716
      *  DESCRIPTION:                                              */   15121716
      *  - Take SMS Contrib   only if Senior Management Severance  */   15121716
      *    Pay Ind (EDB 1122) = 'Y' OR                             */   15121716
      *    Senior Management Severance Pay Exception Ind (EDB 0412)*/   15121716
      *    = 'Y'.                                                  */   15121716
      **************************************************************/   15121716
      **************************************************************/   15731715
      *  PROGRAM: PPNETCLC                                         */   15731715
      *  RELEASE: ___1715______ SERVICE REQUEST(S): ____1573_____  */   15731715
      *  NAME:________JLT______ MODIFICATION DATE:  ___07/28/06__  */   15731715
      *  DESCRIPTION:                                              */   15731715
      *  - RETIREMENT RATES (BASIC AND DCP) SHOULD BE APPLIED TO   */   15731715
      *    EDB MONTHLY HISTORY IN PAIRS BASED ON THE BASIC RATE    */   15731715
      *    BEING ZERO (NOT ON THE DCP RATE BEING ZERO).THAT IS,    */   15731715
      *    THE BASIC RATE IS THE CALCULATION DRIVER.               */   15731715
      *  - POPULATE KUCR LINKAGE WITH EMPL UNIT CODE (EDB 0255)    */   15731715
      *    AND EMP REP CODE.                                       */   15731715
      **************************************************************/   15731715
      **************************************************************/   69761691
      *  PROGRAM: PPNETCLC                                         */   69761691
      *  RELEASE: ___1691______ SERVICE REQUEST(S): ___16976_____  */   69761691
      *  NAME:________JLT______ MODIFICATION DATE:  ___01/20/06__  */   69761691
      *  DESCRIPTION:                                              */   69761691
      *  - TREAT CITIZEN CODE "A" IN THE SAME MANNER AS CODE "N"   */   69761691
      *    FOR FEL PORTION OF FWT GROSS (I.E., TAX AT FLAT RATE    */   69761691
      *    BASED ON VISA TYPE).                                    */   69761691
      *  - INCREMENT TAX TREATY GROSS WITH 'FEL' GROSS WHEN UNDER  */   69761691
      *    LIMIT.                                                  */   69761691
      *  - PASS PPFEDTAX ERROR CODE TO CALLING PROCESS.            */   69761691
      **************************************************************/   69761691
      **************************************************************/   13091670
      *  PROGRAM: PPNETCLC                                         */   13091670
      *  RELEASE: ___1670______ SERVICE REQUEST(S): ____81309____  */   13091670
      *  NAME:_______QUAN______ MODIFICATION DATE:  ___09/07/05__  */   13091670
      *  DESCRIPTION:                                              */   13091670
      *  - Added Special Calc "55" Routine to check whether        */   13091670
      *    Senior Management Supplement Elig Indicator = 'A', 'B', */   13091670
      *    'C', 'D', OR 'E', or Senior Management Supplement       */   13091670
      *    Exception Indicator (EDB 0412) = 'Y' before 742, 743,   */   13091670
      *    744, 745, 746, or 747 deduction is taken.               */   13091670
      *  - Take SMS Deduction only if Senior Management Severance  */   13091670
      *    Pay Ind (EDB 1122) = 'A', 'B', 'C', 'D', OR 'E', OR     */   13091670
      *    Senior Management Severance Pay Exception Ind (EDB 0412)*/   13091670
      *    = 'Y'.                                                  */   13091670
      **************************************************************/   13091670
      **************************************************************/   11671644
      *  PROGRAM: PPNETCLC                                         */   11671644
      *  RELEASE: ___1644______ SERVICE REQUEST(S): ____81167____  */   11671644
      *  NAME:_______QUAN______ MODIFICATION DATE:  ___03/30/05__  */   11671644
      *  DESCRIPTION:                                              */   11671644
      *  - Logic has been modified to check for the new GTN and    */   11671644
      *    DCP Plan Code OF 'Y'.                                   */   11671644
      **************************************************************/   11671644
      **************************************************************/   69331637
      *  PROGRAM: PPNETCLC                                         */   69331637
      *  RELEASE: ___1637______ SERVICE REQUEST(S): ___16933_____  */   69331637
      *  NAME:________JLT______ MODIFICATION DATE:  ___04/20/05__  */   69331637
      *  DESCRIPTION:                                              */   69331637
      *  - REMOVE SPECIAL CODE RELATED TO POSTDOC PROCESSING FOR   */   69331637
      *    PAY CYCLES WITH END DATES IN THE MONTH OF DECEMBER,2004.*/   69331637
      **************************************************************/   69331637
      **************************************************************/   69331612
      *  PROGRAM: PPNETCLC                                         */   69331612
      *  RELEASE: ___1612______ SERVICE REQUEST(S): ___16933_____  */   69331612
      *  NAME:________JLT______ MODIFICATION DATE:  ___09/20/04__  */   69331612
      *  DESCRIPTION:                                              */   69331612
      *  - ADD PROCESSING FOR POSTDOC HANDLING.                    */   69331612
      **************************************************************/   69331612
      **************************************************************/   07401552
      *  PROGRAM: PPNETCLC                                         */   07401552
      *  RELEASE: ___1552______ SERVICE REQUEST(S): ____80740____  */   07401552
      *  NAME:_______QUAN______ MODIFICATION DATE:  ___01/27/04__  */   07401552
      *  DESCRIPTION:                                              */   07401552
      *  - The specific conditions associated with Money Market    */   07401552
      *    Fund and Multi-Asset Fund have been removed from sects  */   07401552
      *    3500-DCP-CALC, 4000-DCP-CASUAL-CALC, and 4500-SSDCP-    */   07401552
      *    CALC.                                                   */   07401552
      *  - Specific conditions associated with the Balanced Growth */   07401552
      *    and Treasury Inflation Protected Securities (TIPS) have */   07401552
      *    been in sections 3500-DCP-CALC, 4000-DCP-CASUAL-CALC,   */   07401552
      *    and 4500-SSDCP-CALC.                                    */   07401552
      **************************************************************/   07401552
      **************************************************************/   48901525
      *  PROGRAM: PPNETCLC                                         */   48901525
      *  RELEASE: ___1525______ SERVICE REQUEST(S): ____14890____  */   48901525
      *  NAME:_______JLT_______ MODIFICATION DATE:  ___10/14/03__  */   48901525
      *  DESCRIPTION:                                              */   48901525
      *  - TAKE FWT TAX FOR CITIZEN CODE E & F WHEN THE YTD TAX    */   48901525
      *    TREATY LIMIT IS EXCEDED.                                */   48901525
      **************************************************************/   48901525
      **************************************************************/   48861503
      *  PROGRAM: PPNETCLC                                         */   48861503
      *  RELEASE: ___1503______ SERVICE REQUEST(S): ____14886____  */   48861503
      *  NAME:___S.ISAACS______ MODIFICATION DATE:  ___07/23/03__  */   48861503
      *  DESCRIPTION:                                              */   48861503
      *     ADDED CODE TO ACCOMODATE NEW FLAT TAX ON BONUSES       */   48861503
      **************************************************************/   48861503
      **************************************************************/   01341440
      *  PROGRAM: PPNETCLC                                         */   01341440
      *  RELEASE: ___1440______ SERVICE REQUEST(S): 80134, 80191_  */   01341440
      *  NAME:__PHIL THOMPSON__ MODIFICATION DATE:  ___11/08/02__  */   01341440
      *  DESCRIPTION:                                              */   01341440
      *  - MODIFIED TO INSPECT COVERAGE WOD FOR Y CHILD VALUE.     */   01341440
      *  - STATEMENT THAT MOVES '1' TO MEDICAL PRIMARY/SECONDARY   */   01341440
      *    FLAG HAS BEEN COMMENTED OUT.                            */   01341440
      *  - SIMILAR TO THE LOGIC FOR  DENTAL, LOGIC IS ADDED TO     */   01341440
      *    TAKE JANUARY PREMIUMS FOR LEGAL WHEN PAY PERIOD END     */   01341440
      *    DATE FALLS IN DECEMBER.                                 */   01341440
      *  - MODIFIED CALL TO MEDICAL RATE UTILITY TO INCLUDE        */   01911440
      *    MEDICAL CONTRIBUTION BASE CURRENT YEAR.                 */   01911440
      **************************************************************/   01341440
      **************************************************************/   48721431
      *  PROGRAM: PPNETCLC                                         */   48721431
      *  RELEASE: ___1431______ SERVICE REQUEST(S): ____14872____  */   48721431
      *  NAME:_______JLT_______ MODIFICATION DATE:  ___08/22/02__  */   48721431
      *  DESCRIPTION:                                              */   48721431
      *  - BLOCK EIC PAYMENT ELIGIBILITY WHEN THE FEDERAL TAX      */   48721431
      *    EXEMPTION CODE IS '999' (NON-RES ALIEN WHO CLAIM        */   48721431
      *    EXEMPTION UNDER TAX TREATY).                            */   48721431
      **************************************************************/   48721431
      **************************************************************/   36401414
      *  PROGRAM: PPNETCLC                                         */   36401414
      *  RELEASE: ___1414______ SERVICE REQUEST(S): ____3640_____  */   36401414
      *  NAME:_______QUAN______ MODIFICATION DATE:  ___05/19/02__  */   36401414
      *  DESCRIPTION:                                              */   36401414
      *  - The value moved to RET-RATE-PRIOR1 should be taken from */   36401414
      *    KUCR-1-MO-RETURN-RATE, not KUCR-1-MO-RETIRE-RATE.       */   36401414
      *    The value originally moved to KUCR-1-MO-RETIRE-RATE is  */   36401414
      *    from RET-RATE-PRIOR1. Thus Zero is moved to             */   36401414
      *    RET-RATE-PRIOR1 again for an employee whose Hire Date   */   36401414
      *    begins one month prior to the current pay period date.  */   36401414
      *  - The value moved to DCP-RATE-PRIOR1 should be taken from */   36401414
      *    KUCR-1-MO-DCP-RETURN-RATE, not KUCR-1-MO-DCP-RATE.      */   36401414
      *    The value originally moved to KUCR-1-MO-DCP-RATE is     */   36401414
      *    from DCP-RATE-PRIOR1. Thus Zero is moved to             */   36401414
      *    DCP-RATE-PRIOR1 again for an employee whose Hire date   */   36401414
      *    begins one month prior to the current pay period date.  */   36401414
      **************************************************************/   36401414
      **************************************************************/   48631400
      *  PROGRAM: PPNETCLC                                         */   48631400
      *  RELEASE: ___1400______ SERVICE REQUEST(S): ____14863____  */   48631400
      *  NAME:_______QUAN______ MODIFICATION DATE:  ___02/22/02__  */   48631400
      *  DESCRIPTION:                                              */   48631400
      *  - ADDED LOGIC TO TEST EARNINGS LIMIT FOR EIC PAYMENT.     */   48631400
      *    CHANGED THE ENDING ENTRIES FOR EXISTING FIRST AND SECOND*/   48631400
      *    EIC RATE SETS. ADDED LOGIC TO ACCESS THE NEW THIRD EIC  */   48631400
      *    RATE SET FOR EMPLOYEES WHSE SPOUSES NOT FILING W-5.     */   48631400
      *  - ADDED LOGIC TO DETERMINE WHETHER CALCULATED EIC PAYMENT */   48631400
      *    HAS REACHED ITS EIC CAP PAYMENT LIMIT. IF SO, SET DEDUCT*/   48631400
      *    TO TAKE TO ZERO.                                        */   48631400
      **************************************************************/   48631400
      **************************************************************/   78391373
      *  PROGRAM: PPNETCLC                                         */   78391373
      *  RELEASE: ___1373______ SERVICE REQUEST(S): ____17839____  */   78391373
      *  NAME:_______JLT_______ MODIFICATION DATE:  ___10/05/01__  */   78391373
      *  DESCRIPTION:                                              */   78391373
      *  - ADDED SPECIAL CALC "50" ROUTINE IN ORDER TO CALCULATE   */   78391373
      *    THE BX INITIATION FEE DEDUCTION. THIS ROUTINE WILL TEST */   78391373
      *    THE "BX" EARNING SWITCH AND IF NOT SET, WILL NOT DERIVE */   78391373
      *    THE DEDUCTION.                                          */   78391373
      **************************************************************/   78391373
      **************************************************************/   52191366
      *  PROGRAM: PPNETCLC                                         */   52191366
      *  RELEASE: ___1366______ SERVICE REQUEST(S): ____15219____  */   52191366
      *  REF RLSE:___1347______                                    */   52191366
      *  NAME:_______QUAN______ MODIFICATION DATE:  ___07/31/01__  */   52191366
      *  DESCRIPTION:                                              */   52191366
      *  - Error report 1755:                                      */   52191366
      *    The logic that sets up the historical retirement gross  */   52191366
      *    entries has been totally rewritten to accommodate both  */   52191366
      *    on-line rush checks and batch compute.                  */   52191366
      **************************************************************/   52191366
      **************************************************************/   52191358
      *  PROGRAM: PPNETCLC                                         */   52191358
      *  RELEASE: ___1358______ SERVICE REQUEST(S): ____15219____  */   52191358
      *  REF RLSE:___1347______                                    */   52191358
      *  NAME:_______QUAN______ MODIFICATION DATE:  ___07/04/01__  */   52191358
      *  DESCRIPTION:                                              */   52191358
      *  - Error report 1747:                                      */   52191358
      *    When this module is triggered via on-line Rush Checks,  */   52191358
      *    and the Pay Period End Date is not in the current       */   52191358
      *    month, the KUCR-MO-RETIRE-GROSS array contains the      */   52191358
      *    retirement Gross in entry 1 (for current) and in one of */   52191358
      *    the subsequnt history gross entries, causing incorrect  */   52191358
      *    calculation of the Regular DCP amount in PPBENUCR.      */   52191358
      **************************************************************/   52191358
      **************************************************************/   52191347
      *  PROGRAM: PPNETCLC                                         */   52191347
      *  RELEASE: ___1347______ SERVICE REQUEST(S): ____15219____  */   52191347
      *  NAME:_______QUAN______ MODIFICATION DATE:  ___03/12/01__  */   52191347
      *  DESCRIPTION:                                              */   52191347
      *  - Added Calc Routine 45 for Faculty Summer Salary.        */   52191347
      *    For employees with Retirement Eligibility Code of P, O, */   52191347
      *    'F', or 'S', they are subject only to the Summer Salary */   52191347
      *    Compensation Limit which is capped at 25% of the value  */   52191347
      *    in System Parameter 067 (currently 170,000).            */   52191347
      *  - Modified calculation of the Regular DCP for Retirement  */   52191347
      *    Code of 'U'.                                            */   52191347
      *  - Modified calculation of the Casual DCP for Retirement   */   52191347
      *    Code of 'H'.                                            */   52191347
      *  - After coming out of PPBENUCR (Reg DCP calc routine),    */   52191347
      *    the actual gross used to calculate the DCP deduction is */   52191347
      *    moved to KNET-GROSS-ADJUST (1), which updates the       */   52191347
      *    current month retirement gross.                         */   52191347
      **************************************************************/   52191347
      **************************************************************/   71921294
      *  PROGRAM: PPNETCLC                                         */   71921294
      *  RELEASE: ___1294______ SERVICE REQUEST(S): ____17192____  */   71921294
      *  NAME:_______JLT_______ MODIFICATION DATE:  ___05/10/00__  */   71921294
      *  DESCRIPTION:                                              */   71921294
      *  - Modified Special Calc "15" routine for Agency Fee.      */   71921294
      **************************************************************/   71921294
      **************************************************************/   71641280
      *  PROGRAM: PPNETCLC                                         */   71641280
      *  RELEASE: ___1280______ SERVICE REQUEST(S): ____17164____  */   71641280
      *  NAME:_____J.WILCOX____ MODIFICATION DATE:  ___02/09/00__  */   71641280
      *  DESCRIPTION:                                              */   71641280
      *  - Added dummy calculation return for calc routine 18. All */   71641280
      *    computations have actually been completed by PPP400 for */   71641280
      *    this routine.                                           */   71641280
      **************************************************************/   71641280
      **************************************************************/   48071211
      *  PROGRAM: PPNETCLC                                         */   48071211
      *  RELEASE: ___1211______ SERVICE REQUEST(S): ____14807____  */   48071211
      *  NAME:__PHIL THOMPSON__ MODIFICATION DATE:  ___10/13/98__  */   48071211
      *  DESCRIPTION:                                              */   48071211
      *  - ADDED PROCESSING TO SUPPORT TRANSPORTATION PRETAX       */   48071211
      *    DEDUCTIONS AND CAPS ON REDUCTION AMOUNT                 */   48071211
      *  - NOTE THAT COPYLIB CPWSXDSA IS NOT EXTERNAL; IT IS USED  */   48071211
      *    TO TEMPORARILY STORED THE CALCULATED PARKING/TRANSIT    */   48071211
      *    DEDUCTIONS.                                             */   48071211
      **************************************************************/   48071211
      **************************************************************/   32181188
      *  PROGRAM: PPNETCLC                                         */   32181188
      *  RELEASE: ___1188______ SERVICE REQUEST(S): ____13218____  */   32181188
      *  NAME:________JLT______ MODIFICATION DATE:  ___06/01/98__  */   32181188
      *  DESCRIPTION:                                              */   32181188
      *  - CALCULATE THE IMPUTED INCOME FOR DOMESTIC PARTNERS.     */   32181188
      ******C*******************************************************/   32181188
      **************************************************************/   25991140
      *  PROGRAM: PPNETCLC                                         */   25991140
      *  RELEASE: ___1140______ SERVICE REQUEST(S): ____12599____  */   25991140
      *  NAME:______M SANO_____ MODIFICATION DATE:  ___08/26/97__  */   25991140
      *  DESCRIPTION:                                              */   25991140
      *  - UPDATE THE PAY CYCLE END DATE BEFORE EACH CALL TO       */   25991140
      *    THE VISION, DENTAL OR MEDICAL BENEFIT RATES MODULE.     */   25991140
      *    IF THE PAY CYCLE END DATE IS IN DECEMBER, CHANGE THE    */   25991140
      *    DATE TO JANUARY OF THE NEXT YEAR BEFORE CALLING THE     */   25991140
      *    MEDICAL, DENTAL OR VISION BENIFITS RATES MODULES.       */   25991140
      **************************************************************/   25991140
      **************************************************************/   34271122
      *  PROGRAM: PPNETCLC                                         */   34271122
      *  RELEASE: ___1122______ SERVICE REQUEST(S): ____13427____  */   34271122
      *  NAME:______M SANO_____ MODIFICATION DATE:  ___04/14/97__  */   34271122
      *  DESCRIPTION:                                              */   34271122
      *  - CHECK FOR GTN BASIS VALUE OF 'T' DURING CAL ROUTINE 15  */   34271122
      *    WHERE GTN USAGES IS 'R' OR '2'. IF 'T' USE TOTAL GROSS  */   34271122
      *    AS BASIS.                                               */   34271122
      **************************************************************/   34271122
      **************************************************************/   28521025
      *  PROGRAM: PPNETCLC                                         */   28521025
      *  RELEASE: ___1025______ SERVICE REQUEST(S): ____12852____  */   28521025
      *  NAME:_______QUAN______ MODIFICATION DATE:  ___08/24/95__  */   28521025
      *  DESCRIPTION:                                              */   28521025
      *  - DATE CONVERSION PROJECT:                                */   28521025
      *    MOVED BENEFITS DATE COVERAGE EFFECT DATE (ISO FORMAT,   */   28521025
      *    FROM EDB) TO BENEFITS DATE COVERAGE EFFECT DATE         */   28521025
      *    IN LINKAGE.                                             */   28521025
      **************************************************************/   28521025
      **************************************************************/   37070927
      *  PROGRAM: PPNETCLC                                         */   37070927
      *  RELEASE: ___0927______ SERVICE REQUEST(S): ____13707____  */   37070927
      *  NAME:__PHIL THOMPSON__ MODIFICATION DATE:  ___09/23/94__  */   37070927
      *  DESCRIPTION:                                              */   37070927
      *  - ADD FIDELITY DCP CASUAL GTN 278 FOR CALC ROUTINE 40     */   37070927
      **************************************************************/   37070927
      **************************************************************/   36400799
      *  PROGRAM: PPNETCLC                                         */   36400799
      *  RELEASE: ___0799______ SERVICE REQUEST(S): _____3640____  */   36400799
      *  NAME:_____SRS_________ MODIFICATION DATE:  ___10/26/92__  */   36400799
      *  DESCRIPTION:                                              */   36400799
      *  - THIS IS A NEW MODULE CONTAINING THE SPECIAL CALCULATION */   36400799
      *  - LOGIC MOVED FROM PROGRAM USER40.                        */   36400799
      **************************************************************/   36400799
       IDENTIFICATION DIVISION.                                         PPNETCLC
       PROGRAM-ID. PPNETCLC.                                            PPNETCLC
       DATE-COMPILED.                                                   PPNETCLC
       ENVIRONMENT DIVISION.                                            PPNETCLC
       DATA DIVISION.                                                   PPNETCLC
       WORKING-STORAGE SECTION.                                         PPNETCLC
                                                                        PPNETCLC
       01  WORK-AREA.                                                   PPNETCLC
           05  GTN-DED-NUM             PIC 9(03)  VALUE  0.             48071211
           05  GTN-DED-NUM-CHAR    REDEFINES                            48071211
               GTN-DED-NUM             PIC X(03).                       48071211
           05  WS-LAST-LINK-GTN        PIC X(03)  VALUE SPACES.         48071211
           05  WS-LAST-EMPLOYEE-ID     PIC X(09)  VALUE SPACES.         48071211
           05  WS-HSA-CHECK-DATE-ACTUAL PIC X(10).                      02312089
           05  WS-HSA-CHECK-DATE.                                       02312089
               10 WS-HSA-CHECK-DATE-CCYY PIC 9(04).                     02312089
               10 WS-HSA-CHECK-DATE-DSH1 PIC X(01).                     02312089
               10 WS-HSA-CHECK-DATE-MM   PIC 9(02).                     02312089
               10 WS-HSA-CHECK-DATE-DSH2 PIC X(01).                     02312089
               10 WS-HSA-CHECK-DATE-DD   PIC 9(02).                     02312089
           05  WS-KNET-DED-GTN-HOLD    PIC S9(07)V99 COMP-3 VALUE +0.   48071211
           05  WS-CALC-AMT-TAKE        PIC S9(07)V99 COMP-3 VALUE +0.   48071211
           05  WS-DED-AMT-TO-TAKE-PARK PIC S9(07)V99 COMP-3 VALUE +0.   48071211
           05  WS-DED-AMT-TO-TAKE-TRAN PIC S9(07)V99 COMP-3 VALUE +0.   48071211
           05  WS-KNET-BASE-TOTAL      PIC S9(09)V99 COMP-3 VALUE +0.   48631400
           05  WS-CURRENT-EIC-PAYMENT  PIC S9(07)V99 COMP-3 VALUE +0.   48631400
           05  WS-OLD-YTD-EIC-PAYMENT  PIC S9(07)V99 COMP-3 VALUE +0.   48631400
           05  WS-TOTAL-YTD-EIC-PAYMENT PIC S9(07)V99 COMP-3 VALUE +0.  48631400
           05  WS-DIFF-EIC-PAYMENT     PIC S9(07)V99 COMP-3 VALUE +0.   48631400
           05  WS-YTD-FWT-GROSS        PIC S9(07)V99 COMP-3 VALUE +0.   48631400
           05  REDUCTION-WK-AMT        PIC S9(7)V99  COMP-3 VALUE +0.   48071211
           05  GTN-ISUB                PIC S9(04) COMP SYNC VALUE +0.   48071211
           05  LIM-SUB                 PIC S9(04) COMP SYNC VALUE +0.   48071211
           05  GTN-SUB                 PIC S9(04) COMP SYNC VALUE +0.   48071211
           05  OFFSET-SUB              PIC S9(04) COMP SYNC VALUE +0.   48071211
           05  WS-INDX                 PIC S9(04) COMP SYNC VALUE +0.   52191366
           05  WS-WORK-GROSS           PIC S9(07)V99 VALUE ZERO COMP-3. 52191366
           05  WS-PAST-HIST-GROSS      PIC S9(07)V99 VALUE ZERO COMP-3. 52191366
           05  WS-WORK-ADJUSTED-GROSS  PIC S9(07)V99 VALUE ZERO COMP-3. 52191366
           05  WS-ADJUST-RET-GROSS     PIC S9(07)V99 VALUE ZERO COMP-3. 52191366
           05  WS-RET-PORTION-OVER-FICA                                 52191347
                                      PIC S9(07)V99 VALUE ZERO  COMP-3. 52191347
           05  WS-FCSS-DCP-GROSS-LIMIT                                  52191347
                                      PIC S9(07)V99 VALUE ZERO  COMP-3. 52191347
           05  WS-SUMMER-SAL-COMP-LIMIT                                 52191347
                                      PIC S9(07)V99 VALUE ZERO  COMP-3. 52191347
           05  WS-SUMMER-SALARY-LIMIT                                   52191347
                                      PIC S9(07)V99 VALUE ZERO  COMP-3. 52191347
           05  WS-RETIREMENT-COMP-LIMIT                                 39362090
                                      PIC S9(07)V99 VALUE ZERO  COMP-3. 39362090
           05  WS-RETIREMENT-LIMIT                                      39362090
                                      PIC S9(07)V99 VALUE ZERO  COMP-3. 39362090
           05  WS-FYTD-DCP-ELIG-GROSS                                   52191347
                                      PIC S9(07)V99 VALUE ZERO  COMP-3. 52191347
           05  WS-COMBN-DCP-COMP-LIMIT                                  52191347
                                      PIC S9(07)V99 VALUE ZERO  COMP-3. 52191347
           05  WS-ADJ-COMBN-DCP-COMP-LIMIT                              52191347
                                      PIC S9(07)V99 VALUE ZERO  COMP-3. 52191347
           05  WS-CURRENT-SUMMER-SALARY-EARNS                           52191347
                                      PIC S9(07)V99 VALUE ZERO  COMP-3. 52191347
           05  WS-CURRENT-SAFE-HARBOR-GROSS                             52191347
                                      PIC S9(07)V99 VALUE ZERO  COMP-3. 52191347
           05  WS-CURRENT-RETIREMENT-GROSS                              52191347
                                      PIC S9(07)V99 VALUE ZERO  COMP-3. 52191347
           05  WS-ADJ-REG-DCP-GROSS-LIMIT                               52191347
                                      PIC S9(07)V99 VALUE ZERO  COMP-3. 52191347
           05  WS-SFHR-DCP-GROSS-LIMIT                                  52191347
                                      PIC S9(07)V99 VALUE ZERO  COMP-3. 52191347
           05  WS-SEL-DCP-GROSS-LIMIT                                   52191347
                                      PIC S9(07)V99 VALUE ZERO  COMP-3. 52191347
           05  ADJ-DOS-FEL-NRA-GRS    PIC S9(07)V99 VALUE ZERO  COMP-3. 69761691
           05  TEMP-AMT-UNDER-LIMIT   PIC S9(07)V99 VALUE ZERO  COMP-3. 69761691
           05  ZTT-REDUCTIONS         PIC S9(07)V99 VALUE ZERO  COMP-3. 48901525
           05  ZTT-ADJ-STATE-GRS      PIC S9(07)V99 VALUE ZERO  COMP-3. 48901525
           05  ZTT-AMT-OVER-LIMIT     PIC S9(07)V99 VALUE ZERO  COMP-3. 48901525
           05  WS-DP-TIP-AMT          PIC S9(5)V99              COMP-3. 30001947
           05  WS-DP-DPI-AMT          PIC S9(5)V99              COMP-3. 30001947
           05  S4                      PIC S9(4)  COMP SYNC VALUE +0.   PPNETCLC
           05  S5                      PIC S9(4)  COMP SYNC VALUE +0.   PPNETCLC
           05  S6                      PIC S9(4)  COMP SYNC VALUE +0.   PPNETCLC
           05  FIRST-TIME-FLAG         PIC X           VALUE 'Y'.       PPNETCLC
               88  FIRST-TIME                          VALUE 'Y'.       PPNETCLC
               88  NOT-FIRST-TIME                      VALUE 'N'.       PPNETCLC
           05  LINK-GTN-FLAG           PIC X           VALUE 'N'.       48071211
               88  LINK-GTN-FOUND                      VALUE 'Y'.       48071211
               88  LINK-GTN-INITIAL                    VALUE 'N'.       48071211
           05  M00931                  PIC 9(5)        VALUE 00931.     PPNETCLC
           05  M40019                  PIC 9(5)        VALUE 40019.     PPNETCLC
           05  M40027                  PIC 9(5)        VALUE 40027.     PPNETCLC
           05  M40077                  PIC 9(5)        VALUE 40077.     PPNETCLC
           05  M40111                  PIC 9(5)        VALUE 40111.     PPNETCLC
           05  M40980                  PIC 9(5)        VALUE 40980.     52191347
           05  M40981                  PIC 9(5)        VALUE 40981.     PPNETCLC
           05  M40983                  PIC 9(5)        VALUE 40983.     PPNETCLC
           05  M40984                  PIC 9(5)        VALUE 40984.     PPNETCLC
           05  M40986                  PIC 9(5)        VALUE 40986.     PPNETCLC
           05  M40987                  PIC 9(5)        VALUE 40987.     PPNETCLC
           05  M40988                  PIC 9(5)        VALUE 40988.     PPNETCLC
           05  M40989                  PIC 9(5)        VALUE 40989.     PPNETCLC
           05  M40990                  PIC 9(5)        VALUE 40990.     PPNETCLC
           05  M40991                  PIC 9(5)        VALUE 40991.     12082230
           05  M40993                  PIC 9(5)        VALUE 40993.     PPNETCLC
           05  M40994                  PIC 9(5)        VALUE 40994.     PPNETCLC
           05  M40995                  PIC 9(5)        VALUE 40995.     PPNETCLC
           05  WS-PPBENADD             PIC X(08) VALUE 'PPBENADD'.      PPNETCLC
           05  WS-PPBENUCR             PIC X(08) VALUE 'PPBENUCR'.      PPNETCLC
           05  WS-PPBENR16             PIC X(08) VALUE 'PPBENR16'.      12082230
           05  WS-PPBENPER             PIC X(08) VALUE 'PPBENPER'.      PPNETCLC
           05  WS-PPBENRTR             PIC X(08) VALUE 'PPBENRTR'.      PPNETCLC
           05  WS-PPBENFCS             PIC X(08) VALUE 'PPBENFCS'.      PPNETCLC
           05  WS-PPBENSCE             PIC X(08) VALUE 'PPBENSCE'.      PPNETCLC
           05  WS-PPBENOCE             PIC X(08) VALUE 'PPBENOCE'.      PPNETCLC
           05  WS-PPBENXHI             PIC X(08) VALUE 'PPBENXHI'.      PPNETCLC
           05  WS-PPBENXDI             PIC X(08) VALUE 'PPBENXDI'.      PPNETCLC
           05  WS-PPBENXLI             PIC X(08) VALUE 'PPBENXLI'.      PPNETCLC
           05  WS-PPBENDLI             PIC X(08) VALUE 'PPBENDLI'.      PPNETCLC
           05  WS-PPBENEPD             PIC X(08) VALUE 'PPBENEPD'.      PPNETCLC
           05  WS-PPBENDIS             PIC X(08) VALUE 'PPBENDIS'.      13872234
           05  WS-PPBENXVI             PIC X(08) VALUE 'PPBENXVI'.      PPNETCLC
           05  WS-PPBENXJD             PIC X(08) VALUE 'PPBENXJD'.      PPNETCLC
           05  WS-PPFSSDCP             PIC X(08) VALUE 'PPFSSDCP'.      52191347
           05  WS-PPBENSH              PIC X(07) VALUE 'PPBENSH'.       PPNETCLC
           05  WS-PPFICA               PIC X(06) VALUE 'PPFICA'.        PPNETCLC
           05  WS-PPFEDTAX             PIC X(08) VALUE 'PPFEDTAX'.      PPNETCLC
           05  WS-PPSTETAX             PIC X(08) VALUE 'PPSTETAX'.      PPNETCLC
           05  WS-PPCOVRGE             PIC X(08) VALUE 'PPCOVRGE'.      30001947
       01  PPFICA-INTERFACE-DATA.            COPY CPWSXFIC.             PPNETCLC
       01  PAYROLL-CONSTANTS.                COPY CPWSXIC2.             PPNETCLC
       01  DEDUCTION-SEGMENT-ARRAY.          COPY CPWSXDSA.             48071211
       01  DATE-CONVERSION-WORK-AREAS. COPY CPWSXDC3.                   25991140
       01  PPBENADD-INTERFACE      EXTERNAL. COPY CPLNKADD.             PPNETCLC
       01  PPBENXDI-INTERFACE      EXTERNAL. COPY CPLNKXDI.             PPNETCLC
       01  PPBENXHI-INTERFACE      EXTERNAL. COPY CPLNKXHI.             PPNETCLC
       01  PPBENXLI-INTERFACE      EXTERNAL. COPY CPLNKXLI.             PPNETCLC
       01  PPBENDLI-INTERFACE      EXTERNAL. COPY CPLNKDLI.             PPNETCLC
       01  PPBENUCR-INTERFACE      EXTERNAL. COPY CPLNKUCR.             PPNETCLC
       01  PPBENR16-INTERFACE      EXTERNAL. COPY CPLNKR16.             12082230
       01  PPBENPER-INTERFACE      EXTERNAL. COPY CPLNKPER.             PPNETCLC
       01  PPBENFCS-INTERFACE      EXTERNAL. COPY CPLNKFCS.             PPNETCLC
       01  PPBENSCE-INTERFACE      EXTERNAL. COPY CPLNKSCE.             PPNETCLC
       01  PPBENOCE-INTERFACE      EXTERNAL. COPY CPLNKOCE.             PPNETCLC
       01  PPBENRTR-INTERFACE      EXTERNAL. COPY CPLNKRTR.             PPNETCLC
       01  PPBENEPD-INTERFACE      EXTERNAL. COPY CPLNKEPD.             PPNETCLC
       01  PPBENDIS-INTERFACE      EXTERNAL. COPY CPLNKDIS.             13872234
       01  PPBENXVI-INTERFACE      EXTERNAL. COPY CPLNKXVI.             PPNETCLC
       01  PPBENXJD-INTERFACE      EXTERNAL. COPY CPLNKXJD.             PPNETCLC
       01  PPFSSDCP-INTERFACE      EXTERNAL. COPY CPLNKFSS.             52191347
       01  PPBENSH-INTERFACE       EXTERNAL. COPY CPLNKSH.              PPNETCLC
       01  PPHDAUTL-INTERFACE      EXTERNAL. COPY CPLNKHDA.             PPNETCLC
       01  FEDERAL-TAX-INTERFACE   EXTERNAL. COPY CPLNKFED.             PPNETCLC
       01  STATE-TAX-INTERFACE     EXTERNAL. COPY CPLNKSTE.             PPNETCLC
       01  FEDERAL-TAX-AREA        EXTERNAL. COPY CPWSXFTA.             PPNETCLC
       01  STX-INFORMATION         EXTERNAL. COPY CPWSXSTT.             PPNETCLC
       01  FEDERAL-EIC-AREA        EXTERNAL. COPY CPWSXFEA.             48631400
       01  KNET-INTERFACE-DATA      EXTERNAL.  COPY CPLNKNET.           PPNETCLC
       01  PPCOVRGE-INTERFACE       EXTERNAL.  COPY CPLNKCOV.           30001947
       01  DEP-DATA-ARRAY           EXTERNAL.  COPY CPWSEDEP.           30001947
       01  XGTN-GROSS-TO-NET-RECORD EXTERNAL.  COPY CPWSXGTN.           PPNETCLC
       01  TRANSIT-GTN-DATA         EXTERNAL.  COPY CPWSTGTN.           48071211
       01  ONLINE-SIGNALS           EXTERNAL.  COPY CPWSONLI.           52191358
                                                                        PPNETCLC
       01  BEN-ROW-DATA EXTERNAL.                                       PPNETCLC
           EXEC SQL                                                     PPNETCLC
                INCLUDE PPPV400A                                        PPNETCLC
           END-EXEC.                                                    PPNETCLC
       01  PAY-ROW-DATA EXTERNAL.                                       PPNETCLC
           EXEC SQL                                                     PPNETCLC
                INCLUDE PPPV400B                                        PPNETCLC
           END-EXEC.                                                    PPNETCLC
                                                                        PPNETCLC
       PROCEDURE DIVISION.                                              PPNETCLC
                                                                        PPNETCLC
       0100-MAINLINE SECTION.                                           PPNETCLC
                                                                        PPNETCLC
           MOVE SPACES TO KNET-MSSG-NO (1)                              PPNETCLC
           IF FIRST-TIME                                                PPNETCLC
              SET NOT-FIRST-TIME TO TRUE                                PPNETCLC
              MOVE '3'           TO KXJD-ACTION-FLAG                    PPNETCLC
                                    KXVI-ACTION-FLAG                    PPNETCLC
                                    KEPD-ACTION-FLAG                    PPNETCLC
                                    KDIS-ACTION-FLAG                    13872234
                                    KDLI-ACTION-FLAG                    PPNETCLC
                                    KXLI-ACTION-FLAG                    PPNETCLC
                                    KXDI-ACTION-FLAG                    PPNETCLC
                                    KADD-ACTION-FLAG                    PPNETCLC
                                    KXHI-ACTION-FLAG                    PPNETCLC
                                    KOCE-ACTION-FLAG                    PPNETCLC
                                    KSCE-ACTION-FLAG                    PPNETCLC
                                    KFCS-ACTION-FLAG                    PPNETCLC
              MOVE KNET-END-YYMMDD                                      28521025
                                TO  KXJD-PAY-CYCLE-END-DATE             28521025
                                    KEPD-PERIOD-END-DATE                PPNETCLC
                                    KDLI-PERIOD-END-DATE                PPNETCLC
                                    KXLI-PERIOD-END-DATE                PPNETCLC
                                    KADD-PERIOD-END-DATE                PPNETCLC
                                    KRTR-PERIOD-END-DATE                PPNETCLC
                                    KUCR-PERIOD-END-DATE                PPNETCLC
           END-IF.                                                      PPNETCLC
                                                                        PPNETCLC
           EVALUATE KNET-ROUTINE                                        PPNETCLC
             WHEN '04'                                                  PPNETCLC
               PERFORM 0400-RETIREMENT-CALC                             PPNETCLC
             WHEN '05'                                                  PPNETCLC
               PERFORM 0500-RETIRE-PERCENT-CALC                         PPNETCLC
             WHEN '32'                                                  12082230
               PERFORM 3200-TIER2016-RETIREMENT-CALC                    12082230
             WHEN '06'                                                  PPNETCLC
               PERFORM 0600-VISION-CALC                                 PPNETCLC
             WHEN '07'                                                  PPNETCLC
               PERFORM 0700-HEALTH-CALC                                 PPNETCLC
             WHEN '08'                                                  PPNETCLC
               PERFORM 0800-DENTAL-CALC                                 PPNETCLC
             WHEN '09'                                                  PPNETCLC
               PERFORM 0900-ADD-CALC                                    PPNETCLC
             WHEN '10'                                                  PPNETCLC
               PERFORM 1000-LIFE-CALC                                   PPNETCLC
             WHEN '12'                                                  PPNETCLC
               PERFORM 1200-EPD-CALC                                    PPNETCLC
             WHEN '13'                                                  13872234
               PERFORM 1300-DISABILITY-CALC                             13872234
             WHEN '15'                                                  PPNETCLC
               PERFORM 1500-MONTHLY-CAP-CALC                            PPNETCLC
             WHEN '16'                                                  48071211
               PERFORM 1600-PARKING-CAP-CALC                            48071211
             WHEN '17'                                                  48071211
               PERFORM 1700-TRANSIT-CAP-CALC                            48071211
             WHEN '18'                                                  71641280
               CONTINUE                                                 71641280
             WHEN '20'                                                  PPNETCLC
               PERFORM 2000-MED-OASDI-CALC                              PPNETCLC
             WHEN '22'                                                  PPNETCLC
               PERFORM 2200-FWT-CALC                                    PPNETCLC
             WHEN '23'                                                  69331612
               PERFORM 2300-FEL-NRA-FWT-CALC                            69331612
             WHEN '24'                                                  PPNETCLC
               PERFORM 2400-EIC-CALC                                    PPNETCLC
             WHEN '25'                                                  PPNETCLC
               PERFORM 2500-SWT-CALC                                    PPNETCLC
             WHEN '30'                                                  PPNETCLC
               PERFORM 3000-LEGAL-CALC                                  PPNETCLC
             WHEN '35'                                                  PPNETCLC
               PERFORM 3500-DCP-CALC                                    PPNETCLC
             WHEN '40'                                                  PPNETCLC
               PERFORM 4000-DCP-CASUAL-CALC                             PPNETCLC
             WHEN '45'                                                  52191347
               PERFORM 4500-SSDCP-CALC                                  52191347
             WHEN '50'                                                  78391373
               PERFORM 5000-BX-INITIATION-FEE                           78391373
             WHEN '55'                                                  13091670
               PERFORM 5500-SMS-ELIGIBILITY                             13091670
             WHEN '60'                                                  02312089
               PERFORM 6000-HSA-CALC                                    02312089
             WHEN OTHER                                                 PPNETCLC
               MOVE M40019 TO KNET-MSSG-NO (1)                          PPNETCLC
           END-EVALUATE.                                                PPNETCLC
                                                                        PPNETCLC
           GOBACK.                                                      PPNETCLC
                                                                        PPNETCLC
       0400-RETIREMENT-CALC SECTION.                                    PPNETCLC
                                                                        PPNETCLC
           MOVE KNET-DEDX TO RETIREMENT-ELEMENTS.                       PPNETCLC
           MOVE ZEROES TO KNET-DED-TO-TAKE                              PPNETCLC
                          KNET-MC-DED-TO-TAKE.                          PPNETCLC
           SET KNET-DCP-283-SW-OFF TO TRUE.                             PPNETCLC
           EVALUATE RET-ELIG-CODE                                       PPNETCLC
             WHEN 'U'                                                   PPNETCLC
             WHEN 'W'                                                   36362075
                   PERFORM 0405-CALC-LIMITS                             52191347
                   PERFORM 0410-UCRS-CALC                               PPNETCLC
             WHEN '1'                                                   PPNETCLC
             WHEN '6'                                                   36362075
                   IF KNET-GROSS-RETR-PART NOT = ZERO                   PPNETCLC
                      PERFORM 0405-CALC-LIMITS                          52191347
                      PERFORM 0410-UCRS-CALC                            PPNETCLC
                   END-IF                                               PPNETCLC
             WHEN 'B'                                                   PPNETCLC
                   IF KNET-DCP-BALAMT-GTN NOT = ZERO                    PPNETCLC
                      SET KNET-DCP-283-SW-ON TO TRUE                    PPNETCLC
                      PERFORM 0405-CALC-LIMITS                          52191347
                      PERFORM 0410-UCRS-CALC                            PPNETCLC
                   END-IF                                               PPNETCLC
             WHEN 'P'                                                   PPNETCLC
                   PERFORM 0440-PERS-CALC                               PPNETCLC
             WHEN '2'                                                   PPNETCLC
                   IF KNET-GROSS-RETR-PART NOT = ZERO                   PPNETCLC
                      PERFORM 0440-PERS-CALC                            PPNETCLC
                   END-IF                                               PPNETCLC
             WHEN 'F'                                                   PPNETCLC
                   PERFORM 0470-FCSRS-CALC                              PPNETCLC
             WHEN '3'                                                   PPNETCLC
                   IF KNET-GROSS-RETR-PART NOT = ZERO                   PPNETCLC
                      PERFORM 0470-FCSRS-CALC                           PPNETCLC
                   END-IF                                               PPNETCLC
             WHEN 'S'                                                   PPNETCLC
                   PERFORM 0480-SCERA-CALC                              PPNETCLC
             WHEN '4'                                                   PPNETCLC
                   IF KNET-GROSS-RETR-PART NOT = ZERO                   PPNETCLC
                      PERFORM 0480-SCERA-CALC                           PPNETCLC
                   END-IF                                               PPNETCLC
             WHEN 'O'                                                   PPNETCLC
                   PERFORM 0490-OCERS-CALC                              PPNETCLC
             WHEN '5'                                                   PPNETCLC
                   IF KNET-GROSS-RETR-PART NOT = ZERO                   PPNETCLC
                      PERFORM 0490-OCERS-CALC                           PPNETCLC
                   END-IF                                               PPNETCLC
           END-EVALUATE.                                                PPNETCLC
           IF KNET-DED-TO-TAKE < ZERO                                   PPNETCLC
              MOVE M40077 TO KNET-MSSG-NO (1)                           PPNETCLC
           END-IF.                                                      PPNETCLC
                                                                        52191347
       0405-CALC-LIMITS         SECTION.                                52191347
                                                                        52191347
      **** MOVE KNET-TOTAL-SSDCP-ELIG-EARN                              12082230
      ****                       TO WS-CURRENT-SUMMER-SALARY-EARNS.     12082230
           MOVE KNET-TOTAL-RETIRE-COVERED-EARN                          52191347
                                 TO WS-CURRENT-RETIREMENT-GROSS.        52191347
           MOVE KNET-TOTAL-ELIG-OASDI-EARN                              52191347
                                 TO WS-CURRENT-SAFE-HARBOR-GROSS.       52191347
                                                                        52191347
           MOVE ZERO TO WS-RETIREMENT-COMP-LIMIT.                       39362090
      *****MOVE ZERO TO WS-SUMMER-SAL-COMP-LIMIT.                       12082230
           IF COV-COMP-LIMIT-CD =  'G'                                  52191347
      *****   COMPUTE WS-SUMMER-SAL-COMP-LIMIT ROUNDED                  12082230
      *--------> From System Parameter 023                              52191347
      *****            = (KNET-COVCOMP-GRANDF-LIMIT * .25)              12082230
              COMPUTE WS-RETIREMENT-COMP-LIMIT                          39362090
                       =  KNET-COVCOMP-GRANDF-LIMIT                     39362090
           ELSE                                                         52191347
              IF COV-COMP-LIMIT-CD = ('N' OR SPACE)                     52191347
      *****      COMPUTE WS-SUMMER-SAL-COMP-LIMIT ROUNDED               12082230
      *--------> From System Parameter 067                              52191347
      *****            = (KNET-COVCOMP-NT-GRANDF-LIMIT * .25)           12082230
              COMPUTE WS-RETIREMENT-COMP-LIMIT                          39362090
                       =  KNET-COVCOMP-NT-GRANDF-LIMIT                  39362090
              END-IF                                                    52191347
           END-IF.                                                      52191347
                                                                        52191347
           COMPUTE WS-FYTD-DCP-ELIG-GROSS =                             39362090
               FTD-SFHR-DCP-GROSS.                                      39362090
           MOVE ZERO TO WS-COMBN-DCP-COMP-LIMIT.                        52191347
           IF COV-COMP-LIMIT-CD =  'G'                                  52191347
              COMPUTE WS-COMBN-DCP-COMP-LIMIT  ROUNDED                  52191347
                      = KNET-COVCOMP-GRANDF-LIMIT                       52191347
                               -  WS-FYTD-DCP-ELIG-GROSS                52191347
           ELSE                                                         52191347
              IF COV-COMP-LIMIT-CD = ('N' OR SPACE)                     52191347
                 COMPUTE WS-COMBN-DCP-COMP-LIMIT  ROUNDED               52191347
                         = KNET-COVCOMP-NT-GRANDF-LIMIT                 52191347
                               -  WS-FYTD-DCP-ELIG-GROSS                52191347
              END-IF                                                    52191347
           END-IF.                                                      52191347
           IF WS-COMBN-DCP-COMP-LIMIT < ZERO                            52191347
              MOVE ZERO TO WS-COMBN-DCP-COMP-LIMIT                      52191347
           END-IF.                                                      52191347
                                                                        52191347
      *****COMPUTE WS-SUMMER-SALARY-LIMIT                               12082230
      *****         =  (WS-SUMMER-SAL-COMP-LIMIT                        12082230
      *****                -  KNET-PRIOR-FYTD-FCSS-DCP-GROSS).          12082230
      *****                                                             12082230
      *****IF WS-SUMMER-SALARY-LIMIT < ZERO                             12082230
      *****   MOVE ZERO TO WS-SUMMER-SALARY-LIMIT                       12082230
      *****END-IF.                                                      12082230
      *****                                                             12082230
      *----> Select lesser of the calculated limits from above          12082230
      *----> and use it for the calculation of the FSS Deduction.       12082230
      *****IF WS-CURRENT-SUMMER-SALARY-EARNS                            12082230
      *****       > WS-SUMMER-SALARY-LIMIT                              12082230
      *****   MOVE WS-SUMMER-SALARY-LIMIT TO WS-FCSS-DCP-GROSS-LIMIT    12082230
      *****ELSE                                                         12082230
      *****   MOVE WS-CURRENT-SUMMER-SALARY-EARNS                       12082230
      *****                               TO WS-FCSS-DCP-GROSS-LIMIT    12082230
      *****END-IF.                                                      12082230
      *****                                                             12082230
      *****MOVE WS-FCSS-DCP-GROSS-LIMIT                                 12082230
      *****                    TO  KFS-FCSS-DCP-GROSS-LIMIT.            12082230
                                                                        52191347
      *----> Calculate the adjusted Combined DCP Compensation limit     52191347
           COMPUTE WS-ADJ-COMBN-DCP-COMP-LIMIT =                        39362090
               WS-COMBN-DCP-COMP-LIMIT.                                 39362090
                                                                        52191347
           IF WS-ADJ-COMBN-DCP-COMP-LIMIT < ZERO                        52191347
              MOVE ZERO TO WS-ADJ-COMBN-DCP-COMP-LIMIT                  52191347
           END-IF.                                                      52191347
                                                                        52191347
      *----> Select lesser of the two calculated limits                 52191347
      *----> for employees with Retirement Code  = UCRP                 39362090
           MOVE ZERO TO WS-SEL-DCP-GROSS-LIMIT.                         52191347
           COMPUTE WS-RETIREMENT-LIMIT =                                39362090
             WS-RETIREMENT-COMP-LIMIT - KNET-FYTD-ADJ-RET-GROSS.        39362090
           IF WS-RETIREMENT-LIMIT < ZERO                                39362090
               MOVE ZERO TO WS-RETIREMENT-LIMIT                         39362090
           END-IF.                                                      39362090
           IF RET-ELIG-CODE = 'U'  OR 'W' OR                            36362075
             (RET-ELIG-CODE = 'B'  AND KNET-DCP-BALAMT-GTN NOT = ZERO)  52191347
              IF WS-RETIREMENT-LIMIT                                    39362090
                                 >  WS-CURRENT-RETIREMENT-GROSS         52191347
                 MOVE WS-CURRENT-RETIREMENT-GROSS                       52191347
                                 TO WS-ADJ-REG-DCP-GROSS-LIMIT          52191347
              ELSE                                                      52191347
                 MOVE WS-RETIREMENT-LIMIT                               39362090
                                 TO WS-ADJ-REG-DCP-GROSS-LIMIT          52191347
              END-IF                                                    52191347
              MOVE WS-ADJ-REG-DCP-GROSS-LIMIT                           52191347
                                 TO WS-SEL-DCP-GROSS-LIMIT              52191347
           END-IF.                                                      52191347
                                                                        52191347
      *----> Select lesser of the two calculated limits                 52191347
      *----> for employees with Retirement Code  = 'H'                  52191347
           IF RET-ELIG-CODE = 'H'                                       52191347
              ADD KNET-DP-DPI-FED-AMT TO WS-CURRENT-SAFE-HARBOR-GROSS   25511947
              IF KSH-REDUCTIONS-SH < 0                                  25511947
                SUBTRACT KSH-REDUCTIONS-SH                              25511947
                  FROM WS-CURRENT-SAFE-HARBOR-GROSS                     25511947
              END-IF                                                    25511947
              IF WS-COMBN-DCP-COMP-LIMIT                                52191347
                                 >  WS-CURRENT-SAFE-HARBOR-GROSS        52191347
                 MOVE WS-CURRENT-SAFE-HARBOR-GROSS                      52191347
                                 TO WS-SFHR-DCP-GROSS-LIMIT             52191347
              ELSE                                                      52191347
                 MOVE WS-COMBN-DCP-COMP-LIMIT                           52191347
                                 TO WS-SFHR-DCP-GROSS-LIMIT             52191347
              END-IF                                                    52191347
              MOVE WS-SFHR-DCP-GROSS-LIMIT                              52191347
                                 TO KSH-SFHR-DCP-GROSS-LIMIT            52191347
           END-IF.                                                      52191347
                                                                        PPNETCLC
       0410-UCRS-CALC SECTION.                                          PPNETCLC
                                                                        PPNETCLC
           IF NOT UCRS-PLAN-5                                           PPNETCLC
              GO TO 0419-UCRS-EXIT                                      PPNETCLC
           END-IF.                                                      PPNETCLC
           MOVE FICA-ELIG-CODE  TO KUCR-FICA-ELIG-CODE.                 PPNETCLC
           MOVE KNET-HIRE-DATE  TO KUCR-DATE-OF-EMPLOYMENT.             PPNETCLC
           MOVE YTD-RET-GROSS   TO KUCR-RETIREMENT-GROSS-YTD.           PPNETCLC
           MOVE RET-RATE-CURRMO TO KUCR-CUR-MO-RETIRE-RATE.             PPNETCLC
           MOVE RET-RATE-PRIOR1 TO KUCR-1-MO-RETIRE-RATE.               PPNETCLC
           MOVE RET-RATE-PRIOR2 TO KUCR-2-MO-RETIRE-RATE.               PPNETCLC
           MOVE RET-RATE-PRIOR3 TO KUCR-3-MO-RETIRE-RATE.               PPNETCLC
           MOVE RET-RATE-PRIOR4 TO KUCR-4-MO-RETIRE-RATE.               PPNETCLC
           MOVE DCP-RATE-CURRMO TO KUCR-CUR-MO-DCP-RATE.                PPNETCLC
           MOVE DCP-RATE-PRIOR1 TO KUCR-1-MO-DCP-RATE.                  PPNETCLC
           MOVE DCP-RATE-PRIOR2 TO KUCR-2-MO-DCP-RATE.                  PPNETCLC
           MOVE DCP-RATE-PRIOR3 TO KUCR-3-MO-DCP-RATE.                  PPNETCLC
           MOVE DCP-RATE-PRIOR4 TO KUCR-4-MO-DCP-RATE.                  PPNETCLC
           IF KNET-GROSS-RETR-PART NOT = ZERO                           PPNETCLC
              MOVE KNET-GROSS-RETR-PART    TO KUCR-RETIREMENT-GROSS     PPNETCLC
              IF RET-ELIG-CODE = ('W' OR '6')                           36362075
                 MOVE 'W'       TO KUCR-RETIRE-SYS-CODE                 36362075
              ELSE                                                      36362075
              MOVE 'U'                     TO KUCR-RETIRE-SYS-CODE      PPNETCLC
              END-IF                                                    36362075
           ELSE                                                         PPNETCLC
              MOVE KNET-GROSS-RETR         TO KUCR-RETIREMENT-GROSS     PPNETCLC
              MOVE RET-ELIG-CODE           TO KUCR-RETIRE-SYS-CODE      PPNETCLC
           END-IF.                                                      PPNETCLC
           MOVE KNET-EMP-UNIT-CODE         TO KUCR-EMP-UNIT-CODE.       15731715
           MOVE KNET-EMP-REP-CODE          TO KUCR-EMP-REP-CODE.        15731715
           MOVE KNET-EMP-BEN-ELIG-UNIT-CD  TO KUCR-BEN-ELIG-UNIT-CD.    17451757
           MOVE KNET-EMP-BEN-ELIG-REP-CD   TO KUCR-BEN-ELIG-REP-CD.     17451757
           MOVE KNET-GROSS-ADJUST (1)      TO KUCR-MO-RETIRE-GROSS (1). PPNETCLC
           MOVE KNET-GROSS-ADJUST (2)      TO KUCR-MO-RETIRE-GROSS (2). PPNETCLC
           MOVE KNET-GROSS-ADJUST (3)      TO KUCR-MO-RETIRE-GROSS (3). PPNETCLC
           MOVE KNET-GROSS-ADJUST (4)      TO KUCR-MO-RETIRE-GROSS (4). PPNETCLC
           MOVE KNET-GROSS-ADJUST (5)      TO KUCR-MO-RETIRE-GROSS (5). PPNETCLC
           MOVE KNET-RTR-SAFETY-IND        TO KUCR-SAFETY-IND.          PPNETCLC
           MOVE KNET-RETR-GROSS-OVR-FICA   TO KUCR-RET-OVER-FICA-MAX.   52191366
           MOVE RET-GROSS-CURRMO TO KUCR-CUR-MO-EDBRET-GROSS.           PPNETCLC
           MOVE RET-GROSS-PRIOR1 TO KUCR-1-MO-EDBRET-GROSS.             PPNETCLC
           MOVE RET-GROSS-PRIOR2 TO KUCR-2-MO-EDBRET-GROSS.             PPNETCLC
           MOVE RET-GROSS-PRIOR3 TO KUCR-3-MO-EDBRET-GROSS.             PPNETCLC
           MOVE RET-GROSS-PRIOR4 TO KUCR-4-MO-EDBRET-GROSS.             PPNETCLC
           MOVE RED-GROSS-CURRMO TO KUCR-CUR-MO-RET-EDBRED-GROSS.       PPNETCLC
           MOVE RED-GROSS-PRIOR1 TO KUCR-1-MO-RET-EDBRED-GROSS.         PPNETCLC
           MOVE RED-GROSS-PRIOR2 TO KUCR-2-MO-RET-EDBRED-GROSS.         PPNETCLC
           MOVE RED-GROSS-PRIOR3 TO KUCR-3-MO-RET-EDBRED-GROSS.         PPNETCLC
           MOVE RED-GROSS-PRIOR4 TO KUCR-4-MO-RET-EDBRED-GROSS.         PPNETCLC
                                                                        52191347
      *---> If the calculated Current Retirement Gross is equal to      52191366
      *---> the calculated Selected DCP Gross Limit, then pass the      52191366
      *---> five entries in historical retirement gross table populated 52191366
      *---> from above to PPBENUCR. Otherwise  modify the               52191366
      *---> appropriate retirement gross entries before calling         52191366
      *---> PPBENUCR.                                                   52191366
                                                                        52191366
      *--> If the calculated DCP Gross Limit is same as Retiremnet Gross52191366
      *--> don't need to call 0420-ADJUST-RET-GROSS to adjust the       52191366
      *--> historical Retiremnet buckets.                               52191366
           IF KUCR-RETIREMENT-GROSS = WS-SEL-DCP-GROSS-LIMIT            52191366
              CONTINUE                                                  52191366
           ELSE                                                         52191366
      *------> Since the Selected DCP Gross Limit is less than the      52191366
      *------> Retirement Gross, need to adjust the portion of the gross52191366
      *------> that is over the FICA limit before calling PPBENUCR.     52191366
              IF WS-SEL-DCP-GROSS-LIMIT NOT = ZERO                      52191366
                 COMPUTE WS-RET-PORTION-OVER-FICA                       52191366
                    = KUCR-RETIREMENT-GROSS - WS-SEL-DCP-GROSS-LIMIT    52191366
                 COMPUTE KUCR-RET-OVER-FICA-MAX                         52191366
                    = KUCR-RET-OVER-FICA-MAX - WS-RET-PORTION-OVER-FICA 52191366
                 IF KUCR-RET-OVER-FICA-MAX  < ZERO                      52191366
                    MOVE ZERO TO  KUCR-RET-OVER-FICA-MAX                52191366
                 END-IF                                                 52191366
              END-IF                                                    52191366
              PERFORM 0420-ADJUST-RET-GROSS                             52191366
           END-IF.                                                      52191366
                                                                        52191366
           CALL WS-PPBENUCR.                                            PPNETCLC
           IF KUCR-RETURN-STATUS-ABORTING                               PPNETCLC
              MOVE M40986 TO KNET-MSSG-NO (1)                           PPNETCLC
              GOBACK                                                    PPNETCLC
           END-IF.                                                      PPNETCLC
           IF RET-RATE-CURRMO = ZEROS                                   PPNETCLC
            AND WS-SEL-DCP-GROSS-LIMIT NOT = ZERO                       52191366
              MOVE KUCR-PRIM-DCP-RATE TO DCP-RATE-CURRMO                PPNETCLC
              MOVE KUCR-PRIM-RET-RATE TO RET-RATE-CURRMO                PPNETCLC
           END-IF.                                                      PPNETCLC
           IF   RET-RATE-PRIOR1 = ZEROS                                 PPNETCLC
            AND KUCR-1-MO-RETURN-RATE NOT = ZEROS                       PPNETCLC
                MOVE KUCR-1-MO-RETURN-RATE TO RET-RATE-PRIOR1           36401414
                MOVE KUCR-1-MO-DCP-RETURN-RATE TO DCP-RATE-PRIOR1       36401414
           END-IF.                                                      PPNETCLC
                                                                        52191347
      *----> The actual retirement gross whether a partial or full      52191347
      *----> gross used to calculate the regular DCP deduction in       52191347
      *----> PPBENUCR is moved to KNET-REG-DCP-LIMIT, which will be     52191347
      *----> used to update RET_GROSS_CURRMO (EDB 5520) later.          52191347
           IF ZERO =   KUCR-MO-RETIRE-GROSS (1)                         52191366
              AND      KUCR-MO-RETIRE-GROSS (2)                         52191366
              AND      KUCR-MO-RETIRE-GROSS (3)                         52191366
              AND      KUCR-MO-RETIRE-GROSS (4)                         52191366
              AND      KUCR-MO-RETIRE-GROSS (5)                         52191366
                  MOVE ZERO TO KNET-REG-DCP-LIMIT                       52191366
           ELSE                                                         52191366
               MOVE KUCR-MO-RETIRE-GROSS (1) TO KNET-REG-DCP-LIMIT      52191366
           END-IF.                                                      52191366
                                                                        52191347
           MOVE RET-RATE-CURRMO TO KNET-RETIREMENT-RATE.                PPNETCLC
           MOVE KUCR-TOT-BASIC-DED   TO KNET-DED-TO-TAKE.               PPNETCLC
           MOVE KUCR-TOT-DCP-DED     TO KNET-DCP-DED-TO-TAKE.           PPNETCLC
           MOVE KUCR-TOT-RET-REDUC   TO KNET-MC-DED-TO-TAKE.            PPNETCLC
                                                                        PPNETCLC
       0419-UCRS-EXIT.                                                  PPNETCLC
           EXIT.                                                        PPNETCLC
                                                                        52191366
       0420-ADJUST-RET-GROSS SECTION.                                   52191366
                                                                        52191366
           MOVE ZERO TO WS-WORK-ADJUSTED-GROSS                          52191366
                        WS-WORK-GROSS                                   52191366
                        WS-PAST-HIST-GROSS.                             52191366
                                                                        52191366
                                                                        52191366
           ADD KUCR-MO-RETIRE-GROSS (1) TO WS-WORK-ADJUSTED-GROSS.      52191366
           ADD KUCR-MO-RETIRE-GROSS (2) TO WS-WORK-ADJUSTED-GROSS.      52191366
           ADD KUCR-MO-RETIRE-GROSS (3) TO WS-WORK-ADJUSTED-GROSS.      52191366
           ADD KUCR-MO-RETIRE-GROSS (4) TO WS-WORK-ADJUSTED-GROSS.      52191366
           ADD KUCR-MO-RETIRE-GROSS (5) TO WS-WORK-ADJUSTED-GROSS.      52191366
                                                                        52191366
           IF WS-SEL-DCP-GROSS-LIMIT  = ZERO                            52191366
              MOVE ZERO TO KUCR-RET-OVER-FICA-MAX                       52191366
              MOVE ZERO TO KUCR-MO-RETIRE-GROSS (1)                     52191366
              IF KUCR-MO-RETIRE-GROSS (2) > ZERO                        52191366
                 MOVE ZERO TO KUCR-MO-RETIRE-GROSS (2)                  52191366
              END-IF                                                    52191366
              IF KUCR-MO-RETIRE-GROSS (3) > ZERO                        52191366
                 MOVE ZERO TO KUCR-MO-RETIRE-GROSS (3)                  52191366
              END-IF                                                    52191366
              IF KUCR-MO-RETIRE-GROSS (4) > ZERO                        52191366
                 MOVE ZERO TO KUCR-MO-RETIRE-GROSS (4)                  52191366
              END-IF                                                    52191366
              IF KUCR-MO-RETIRE-GROSS (5) > ZERO                        52191366
                 MOVE ZERO TO KUCR-MO-RETIRE-GROSS (5)                  52191366
              END-IF                                                    52191366
           ELSE                                                         52191366
              SUBTRACT WS-WORK-ADJUSTED-GROSS                           52191366
                                FROM  KUCR-RETIREMENT-GROSS             52191366
                        GIVING WS-PAST-HIST-GROSS                       52191366
              IF WS-PAST-HIST-GROSS < ZERO                              52191366
                 MOVE ZERO TO WS-PAST-HIST-GROSS                        52191366
              END-IF                                                    52191366
           END-IF.                                                      52191366
           IF KUCR-RETIREMENT-GROSS = WS-SEL-DCP-GROSS-LIMIT            52191366
              MOVE ZERO TO WS-WORK-GROSS                                52191366
           ELSE                                                         52191366
               MOVE WS-SEL-DCP-GROSS-LIMIT  TO WS-WORK-GROSS            52191366
               SUBTRACT  WS-PAST-HIST-GROSS FROM WS-WORK-GROSS          52191366
           END-IF.                                                      52191366
                                                                        52191366
           PERFORM VARYING WS-INDX FROM 1  BY  1                        39362090
              UNTIL WS-INDX >  5                                        39362090
                    OR WS-WORK-GROSS = ZERO                             52191366
              IF KUCR-MO-RETIRE-GROSS (WS-INDX) < ZERO                  52191366
                 CONTINUE                                               52191366
              ELSE                                                      52191366
                 IF KUCR-MO-RETIRE-GROSS (WS-INDX) < WS-WORK-GROSS      52191366
                    SUBTRACT KUCR-MO-RETIRE-GROSS (WS-INDX)             52191366
                                              FROM WS-WORK-GROSS        52191366
                 ELSE                                                   52191366
                    IF KUCR-MO-RETIRE-GROSS (WS-INDX)                   52191366
                                           >  WS-WORK-GROSS             52191366
                       MOVE WS-WORK-GROSS                               52191366
                                       TO KUCR-MO-RETIRE-GROSS (WS-INDX)52191366
                       SUBTRACT WS-WORK-GROSS                           52191366
                                           FROM WS-WORK-GROSS           52191366
                    END-IF                                              52191366
                 END-IF                                                 52191366
              END-IF                                                    52191366
                                                                        52191366
           END-PERFORM.                                                 52191366
           MOVE ZERO TO WS-ADJUST-RET-GROSS.                            52191366
           ADD KUCR-MO-RETIRE-GROSS (1) TO WS-ADJUST-RET-GROSS.         52191366
           ADD KUCR-MO-RETIRE-GROSS (2) TO WS-ADJUST-RET-GROSS.         52191366
           ADD KUCR-MO-RETIRE-GROSS (3) TO WS-ADJUST-RET-GROSS.         52191366
           ADD KUCR-MO-RETIRE-GROSS (4) TO WS-ADJUST-RET-GROSS.         52191366
           ADD KUCR-MO-RETIRE-GROSS (5) TO WS-ADJUST-RET-GROSS.         52191366
           ADD WS-PAST-HIST-GROSS TO WS-ADJUST-RET-GROSS.               52191366
           MOVE WS-ADJUST-RET-GROSS TO KUCR-RETIREMENT-GROSS.           52191366
                                                                        52191366
       0429-ADJUST-EXIT.                                                52191366
           EXIT.                                                        52191366
                                                                        52191366
                                                                        PPNETCLC
       0440-PERS-CALC SECTION.                                          PPNETCLC
                                                                        PPNETCLC
           IF NOT PERS-BASIC                                            PPNETCLC
              GO TO 0449-PERS-EXIT                                      PPNETCLC
           END-IF.                                                      PPNETCLC
           MOVE FICA-ELIG-CODE          TO KPER-FICA-ELIG-CODE.         PPNETCLC
           MOVE KNET-PRI-PAY-SCHED      TO KPER-DED-PAY-SCHED-CODE.     PPNETCLC
           IF KNET-GROSS-RETR-PART NOT = ZERO                           PPNETCLC
              MOVE KNET-GROSS-RETR-PART TO KPER-RETIREMENT-GROSS        PPNETCLC
              MOVE 'P'                  TO KPER-RETIRE-SYS-CODE         PPNETCLC
           ELSE                                                         PPNETCLC
              MOVE KNET-GROSS-RETR      TO KPER-RETIREMENT-GROSS        PPNETCLC
              MOVE RET-ELIG-CODE        TO KPER-RETIRE-SYS-CODE         PPNETCLC
           END-IF.                                                      PPNETCLC
           MOVE KNET-GROSS-ADJUST (1)   TO KPER-MO-RETIRE-GROSS (1).    PPNETCLC
           MOVE KNET-GROSS-ADJUST (2)   TO KPER-MO-RETIRE-GROSS (2).    PPNETCLC
           MOVE KNET-GROSS-ADJUST (3)   TO KPER-MO-RETIRE-GROSS (3).    PPNETCLC
           MOVE KNET-GROSS-ADJUST (4)   TO KPER-MO-RETIRE-GROSS (4).    PPNETCLC
           MOVE KNET-GROSS-ADJUST (5)   TO KPER-MO-RETIRE-GROSS (5).    PPNETCLC
           CALL WS-PPBENPER.                                            PPNETCLC
           IF KPER-RETURN-STATUS-ABORTING                               PPNETCLC
              MOVE M40983 TO KNET-MSSG-NO (1)                           PPNETCLC
              GOBACK                                                    PPNETCLC
           END-IF.                                                      PPNETCLC
           MOVE KPER-CUR-MO-RETIRE-GROSS-ADJ TO KNET-GROSS-ADJUST (1).  PPNETCLC
           MOVE KPER-CUR-MO-RETIRE-RATE   TO RET-RATE-CURRMO.           PPNETCLC
           MOVE KPER-CUR-MO-PORT-DED      TO KRTR-CUR-MO-RET-PORT-DED.  PPNETCLC
           MOVE KPER-1-MO-PORT-DED        TO KRTR-1-MO-RET-PORT-DED.    PPNETCLC
           MOVE KPER-2-MO-PORT-DED        TO KRTR-2-MO-RET-PORT-DED.    PPNETCLC
           MOVE KPER-3-MO-PORT-DED        TO KRTR-3-MO-RET-PORT-DED.    PPNETCLC
           MOVE KPER-4-MO-PORT-DED        TO KRTR-4-MO-RET-PORT-DED.    PPNETCLC
           MOVE ZEROS                     TO KRTR-HIST-RET-PORT-DED.    PPNETCLC
           MOVE KPER-TOT-PERS-RETIRE-DEDS TO KNET-DED-TO-TAKE.          PPNETCLC
           MOVE KPER-CUR-MO-RETIRE-RATE   TO RET-RATE-CURRMO            PPNETCLC
                                             KNET-RETIREMENT-RATE.      PPNETCLC
           IF KNET-GROSS-RETR  = ZERO                                   PPNETCLC
           AND KNET-GROSS-RETR-PART = ZERO                              PPNETCLC
               GO TO 0449-PERS-EXIT                                     PPNETCLC
           END-IF.                                                      PPNETCLC
           MOVE KNET-HIRE-DATE TO KRTR-DATE-OF-EMPLOYMENT.              PPNETCLC
           IF RET-ELIG-CODE = '2'                                       PPNETCLC
              MOVE 'P' TO KRTR-RETIRE-SYS-CODE                          PPNETCLC
           ELSE                                                         PPNETCLC
              MOVE RET-ELIG-CODE TO KRTR-RETIRE-SYS-CODE                PPNETCLC
           END-IF.                                                      PPNETCLC
           MOVE RET-GROSS-CURRMO TO KRTR-CUR-MO-RETIRE-GROSS.           PPNETCLC
           MOVE RET-GROSS-PRIOR1 TO KRTR-1-MO-RETIRE-GROSS.             PPNETCLC
           MOVE RET-GROSS-PRIOR2 TO KRTR-2-MO-RETIRE-GROSS.             PPNETCLC
           MOVE RET-GROSS-PRIOR3 TO KRTR-3-MO-RETIRE-GROSS.             PPNETCLC
           MOVE RET-GROSS-PRIOR4 TO KRTR-4-MO-RETIRE-GROSS.             PPNETCLC
           MOVE RED-GROSS-CURRMO TO KRTR-CUR-MO-RETIRE-RED-GROSS.       PPNETCLC
           MOVE RED-GROSS-PRIOR1 TO KRTR-1-MO-RETIRE-RED-GROSS.         PPNETCLC
           MOVE RED-GROSS-PRIOR2 TO KRTR-2-MO-RETIRE-RED-GROSS.         PPNETCLC
           MOVE RED-GROSS-PRIOR3 TO KRTR-3-MO-RETIRE-RED-GROSS.         PPNETCLC
           MOVE RED-GROSS-PRIOR4 TO KRTR-4-MO-RETIRE-RED-GROSS.         PPNETCLC
           MOVE RET-RATE-CURRMO  TO KRTR-CUR-MO-RETIRE-RATE.            PPNETCLC
           MOVE RET-RATE-PRIOR1  TO KRTR-1-MO-RETIRE-RATE.              PPNETCLC
           MOVE RET-RATE-PRIOR2  TO KRTR-2-MO-RETIRE-RATE.              PPNETCLC
           MOVE RET-RATE-PRIOR3  TO KRTR-3-MO-RETIRE-RATE.              PPNETCLC
           MOVE RET-RATE-PRIOR4  TO KRTR-4-MO-RETIRE-RATE.              PPNETCLC
           IF KNET-GROSS-RETR-PART NOT = ZERO                           PPNETCLC
              MOVE KNET-GROSS-RETR-PART TO KRTR-RETIREMENT-GROSS        PPNETCLC
           ELSE                                                         PPNETCLC
              MOVE KNET-GROSS-RETR      TO KRTR-RETIREMENT-GROSS        PPNETCLC
           END-IF.                                                      PPNETCLC
           MOVE KNET-RETR-GROSS-OVR-FICA TO KRTR-RET-OVER-FICA-MAX.     PPNETCLC
           MOVE KNET-GROSS-ADJUST (1)    TO KRTR-CUR-MO-RET-GROSS-ADJ.  PPNETCLC
           MOVE KNET-GROSS-ADJUST (2)    TO KRTR-1-MO-RET-GROSS-ADJ.    PPNETCLC
           MOVE KNET-GROSS-ADJUST (3)    TO KRTR-2-MO-RET-GROSS-ADJ.    PPNETCLC
           MOVE KNET-GROSS-ADJUST (4)    TO KRTR-3-MO-RET-GROSS-ADJ.    PPNETCLC
           MOVE KNET-GROSS-ADJUST (5)    TO KRTR-4-MO-RET-GROSS-ADJ.    PPNETCLC
           MOVE KNET-DED-TO-TAKE         TO KRTR-TOTAL-RET-DED.         PPNETCLC
           CALL WS-PPBENRTR.                                            PPNETCLC
           IF KRTR-RETURN-STATUS-ABORTING                               PPNETCLC
              MOVE M40984 TO KNET-MSSG-NO (1)                           PPNETCLC
              GOBACK                                                    PPNETCLC
           END-IF.                                                      PPNETCLC
           IF   RET-RATE-PRIOR1 = ZEROS                                 PPNETCLC
            AND KRTR-CALCD-1-MO-OLD-RATE NOT = ZEROS                    PPNETCLC
                MOVE KRTR-CALCD-1-MO-OLD-RATE TO RET-RATE-PRIOR1        PPNETCLC
           END-IF.                                                      PPNETCLC
           IF RET-RATE-CURRMO = ZEROS                                   PPNETCLC
              MOVE KRTR-CALCD-CUR-MO-RATE TO RET-RATE-CURRMO            PPNETCLC
           END-IF.                                                      PPNETCLC
           MOVE KRTR-TOT-RET-RED     TO KNET-MC-DED-TO-TAKE.            PPNETCLC
           MOVE KRTR-TOT-RET-DED-ADJ TO KNET-DED-TO-TAKE.               PPNETCLC
                                                                        PPNETCLC
       0449-PERS-EXIT.                                                  PPNETCLC
           EXIT.                                                        PPNETCLC
                                                                        PPNETCLC
       0470-FCSRS-CALC SECTION.                                         PPNETCLC
                                                                        PPNETCLC
           IF FCSRS-BASIC                                               PPNETCLC
              IF KNET-GROSS-RETR-PART NOT = ZERO                        PPNETCLC
                 MOVE KNET-GROSS-RETR-PART TO KFCS-RETIREMENT-GROSS     PPNETCLC
                 MOVE 'F'                  TO KFCS-SYSTEM-CODE          PPNETCLC
              ELSE                                                      PPNETCLC
                 MOVE KNET-GROSS-RETR      TO KFCS-RETIREMENT-GROSS     PPNETCLC
                 MOVE RET-ELIG-CODE        TO KFCS-SYSTEM-CODE          PPNETCLC
              END-IF                                                    PPNETCLC
              CALL WS-PPBENFCS                                          PPNETCLC
              MOVE KFCS-RATE-AMOUNT TO KNET-RETIREMENT-RATE             PPNETCLC
              MOVE KFCS-DED-AMOUNT TO KNET-DED-TO-TAKE                  PPNETCLC
           END-IF.                                                      PPNETCLC
                                                                        PPNETCLC
       0480-SCERA-CALC SECTION.                                         PPNETCLC
                                                                        PPNETCLC
           IF SCERA-BASIC                                               PPNETCLC
              IF KNET-GROSS-RETR-PART NOT = ZERO                        PPNETCLC
                 MOVE KNET-GROSS-RETR-PART TO KSCE-RETIREMENT-GROSS     PPNETCLC
                 MOVE 'S'                  TO KSCE-SYSTEM-CODE          PPNETCLC
              ELSE                                                      PPNETCLC
                 MOVE KNET-GROSS-RETR      TO KSCE-RETIREMENT-GROSS     PPNETCLC
                 MOVE RET-ELIG-CODE        TO KSCE-SYSTEM-CODE          PPNETCLC
              END-IF                                                    PPNETCLC
              MOVE KNET-DED-BALAMT-GTN TO KSCE-RETIREMENT-RATE          PPNETCLC
              CALL WS-PPBENSCE                                          PPNETCLC
              MOVE KSCE-DED-AMOUNT TO KNET-DED-TO-TAKE                  PPNETCLC
              MOVE KSCE-RETIREMENT-RATE TO KNET-RETIREMENT-RATE         PPNETCLC
           END-IF.                                                      PPNETCLC
                                                                        PPNETCLC
       0490-OCERS-CALC SECTION.                                         PPNETCLC
                                                                        PPNETCLC
           IF OCERS-BASIC                                               PPNETCLC
              IF KNET-GROSS-RETR-PART NOT = ZERO                        PPNETCLC
                 MOVE KNET-GROSS-RETR-PART TO KOCE-RETIREMENT-GROSS     PPNETCLC
                 MOVE 'O'                  TO KOCE-SYSTEM-CODE          PPNETCLC
              ELSE                                                      PPNETCLC
                 MOVE KNET-GROSS-RETR      TO KOCE-RETIREMENT-GROSS     PPNETCLC
                 MOVE RET-ELIG-CODE        TO KOCE-SYSTEM-CODE          PPNETCLC
              END-IF                                                    PPNETCLC
              MOVE KNET-DED-BALAMT-GTN TO KOCE-RETIREMENT-RATE          PPNETCLC
              CALL WS-PPBENOCE                                          PPNETCLC
              MOVE KOCE-DED-AMOUNT TO KNET-DED-TO-TAKE                  PPNETCLC
              MOVE KOCE-RETIREMENT-RATE TO KNET-RETIREMENT-RATE         PPNETCLC
           END-IF.                                                      PPNETCLC
                                                                        PPNETCLC
       0500-RETIRE-PERCENT-CALC SECTION.                                PPNETCLC
                                                                        PPNETCLC
           IF KNET-RTN-05-TOT-PRCNT NOT = ZERO                          PPNETCLC
              COMPUTE KNET-DED-TO-TAKE ROUNDED                          PPNETCLC
                    = (KNET-DED-BALAMT-GTN / KNET-RTN-05-TOT-PRCNT)     PPNETCLC
                    *  KNET-RTN-05-TOT-DEDCTN                           PPNETCLC
           END-IF.                                                      PPNETCLC
                                                                        PPNETCLC
       0600-VISION-CALC SECTION.                                        PPNETCLC
                                                                        PPNETCLC
           IF XGTN-BENEFIT-TYPE = 'V'                                   PPNETCLC
            IF XGTN-BENEFIT-PLAN = VIS-PLAN                             PPNETCLC
               MOVE VIS-COVEFFDATE TO KXVI-COVERAGE-EFFECT-DATE         28521025
               MOVE VIS-PLAN TO KXVI-PLAN-CODE                          PPNETCLC
               MOVE VIS-COVERAGE TO KXVI-COVERAGE-CODE                  PPNETCLC
               MOVE KNET-DED-BRSC-ARRAY TO KXVI-BRSC                    PPNETCLC
               MOVE KNET-END-YYMMDD TO XDC3-STD-DATE                    25991140
               IF XDC3-STD-MM = 12                                      25991140
                  MOVE 01 TO XDC3-STD-MM                                25991140
                  ADD 01 TO XDC3-STD-YY                                 25991140
               END-IF                                                   25991140
               MOVE XDC3-STD-DATE TO KXVI-PAY-CYCLE-END-DATE            25991140
               CALL WS-PPBENXVI                                         PPNETCLC
               IF KXVI-RETURN-STATUS-ABORTING                           PPNETCLC
                  MOVE M40990 TO KNET-MSSG-NO (1)                       PPNETCLC
                  GOBACK                                                PPNETCLC
               ELSE                                                     PPNETCLC
                  MOVE KXVI-EMPLOYEE-DEDUCTION TO KNET-DED-TO-TAKE      PPNETCLC
                  MOVE KXVI-EMPLOYER-CONTRIBUTION TO KNET-MC-DED-TO-TAKEPPNETCLC
      *----------> DEVELOP DOMESTIC PARTNERS TIP AND DPI AMOUNTS        32181188
                  IF VIS-COVERAGE-WODV NOT = SPACES                     30001947
                      SET COMPUTE-FEDERAL TO TRUE                       30001947
                      PERFORM 0601-VISION-WOD                           30001947
                      MOVE WS-DP-TIP-AMT TO KNET-DP-TIP-FED-AMT         30001947
                      MOVE WS-DP-DPI-AMT TO KNET-DP-DPI-FED-AMT         30001947
                      IF STATE-DECLAR-DPI = 'Y'                         30001947
                          SET COMPUTE-CA-SDDP TO TRUE                   30001947
                      ELSE                                              30001947
                          SET COMPUTE-CA      TO TRUE                   30001947
                      END-IF                                            30001947
                      PERFORM 0601-VISION-WOD                           30001947
                      MOVE WS-DP-TIP-AMT TO KNET-DP-TIP-CA-AMT          30001947
                      MOVE WS-DP-DPI-AMT TO KNET-DP-DPI-CA-AMT          30001947
                  END-IF                                                30001947
                  PERFORM 9000-BEN-STATUS-CHK                           PPNETCLC
                  IF KXVI-RETURN-STATUS-FLAG = '2'                      PPNETCLC
                     MOVE M40111 TO KNET-MSSG-NO (1)                    PPNETCLC
                  END-IF                                                PPNETCLC
               END-IF                                                   PPNETCLC
            END-IF                                                      PPNETCLC
           END-IF.                                                      PPNETCLC
                                                                        30001947
                                                                        30001947
       0601-VISION-WOD  SECTION.                                        30001947
                                                                        30001947
           MOVE ZERO TO WS-DP-TIP-AMT.                                  30001947
           MOVE ZERO TO WS-DP-DPI-AMT.                                  30001947
           IF KNET-DP-DPI-FED-GTN > ZERO                                30001947
             AND KNET-DP-TIP-FED-GTN > ZERO                             30001947
             AND KNET-DP-DPI-CA-GTN > ZERO                              30001947
             AND KNET-DP-TIP-CA-GTN > ZERO                              30001947
               MOVE VIS-COVERAGE-WODV TO KXVI-COVERAGE-CODE             30001947
               SET VISION-BENEFIT TO TRUE                               30001947
               MOVE KNET-END-YYMMDD TO XDC3-STD-DATE                    30001947
      **** Move 1 to the day and add 1 to the month                     EFIX1998
               MOVE 01              TO XDC3-STD-DD                      EFIX1998
               IF XDC3-STD-MM = 12                                      30001947
                  MOVE 01 TO XDC3-STD-MM                                30001947
                  ADD 01 TO XDC3-STD-YY                                 30001947
               ELSE                                                     EFIX1998
                  ADD 01            TO XDC3-STD-MM                      EFIX1998
               END-IF                                                   30001947
               PERFORM XDC3-CONVERT-STD-TO-ISO                          30001947
               MOVE XDC3-ISO-DATE TO KCOV-EFFECTIVE-DATE-1              30001947
               MOVE KNET-CHECK-DATE TO XDC3-STD-DATE                    30001947
               PERFORM XDC3-CONVERT-STD-TO-ISO                          30001947
               MOVE XDC3-ISO-DATE TO KCOV-EFFECTIVE-DATE-2              30001947
               CALL WS-PPCOVRGE                                         30001947
                 USING PPCOVRGE-INTERFACE,                              30001947
                       DEP-DATA-ARRAY                                   30001947
               IF KCOV-NORMAL                                           30001947
                   IF KCOV-COV-CODE-WOD = SPACES                        30001947
                       MOVE VIS-COVERAGE TO KCOV-COV-CODE-WOD           30001947
                   END-IF                                               30001947
                   MOVE KCOV-COV-CODE-WOD TO KXVI-COVERAGE-CODE         30001947
               ELSE                                                     30001947
                   MOVE VIS-COVERAGE-WODV TO KXVI-COVERAGE-CODE         30001947
               END-IF                                                   30001947
               INSPECT KXVI-COVERAGE-CODE                               30001947
                 REPLACING  ALL 'X'  BY ' '                             30001947
               INSPECT KXVI-COVERAGE-CODE                               30001947
                 REPLACING  ALL 'Y'  BY ' '                             30001947
               IF KXVI-COVERAGE-CODE (2:1) = ' '                        30001947
                   MOVE KXVI-COVERAGE-CODE (3:1)                        30001947
                     TO KXVI-COVERAGE-CODE (2:1)                        30001947
                   MOVE ' ' TO KXVI-COVERAGE-CODE (3:1)                 30001947
               END-IF                                                   30001947
               CALL WS-PPBENXVI                                         30001947
               IF KXVI-RETURN-STATUS-ABORTING                           30001947
                   MOVE M40990 TO KNET-MSSG-NO (1)                      30001947
                   GOBACK                                               30001947
               ELSE                                                     30001947
                   COMPUTE WS-DP-TIP-AMT  = KNET-DED-TO-TAKE            30001947
                                     - KXVI-EMPLOYEE-DEDUCTION          30001947
                   COMPUTE WS-DP-DPI-AMT  = KNET-MC-DED-TO-TAKE         30001947
                                     - KXVI-EMPLOYER-CONTRIBUTION       30001947
                   IF  WS-DP-DPI-AMT  < ZERO                            30001947
                    OR WS-DP-TIP-AMT  < ZERO                            30001947
                       MOVE ZERO  TO WS-DP-DPI-AMT                      30001947
                       MOVE ZERO  TO WS-DP-TIP-AMT                      30001947
                   END-IF                                               30001947
               END-IF                                                   30001947
           END-IF.                                                      30001947
                                                                        PPNETCLC
                                                                        PPNETCLC
       0700-HEALTH-CALC SECTION.                                        PPNETCLC
                                                                        PPNETCLC
           IF XGTN-BENEFIT-TYPE = 'H'                                   PPNETCLC
            IF XGTN-BENEFIT-PLAN = HLTH-PLAN                            PPNETCLC
               MOVE HLTH-COVEFFDATE TO KXHI-1-COVERAGE-EFFECT-DATE      28521025
               MOVE HLTH-PLAN TO KXHI-1-PLAN-CODE                       PPNETCLC
               MOVE HLTH-COVERCODE TO KXHI-1-COVERAGE-CODE              PPNETCLC
               MOVE KNET-EMP-BEN-RATE-LOOKUP-KEY TO KXHI-1-BRSC         15401735
               MOVE KNET-END-YYMMDD TO XDC3-STD-DATE                    25991140
               IF XDC3-STD-MM = 12                                      25991140
                  MOVE MED-CONT-BASE-NEXT TO KXHI-SALARY-BASE           01911440
               ELSE                                                     01911440
                  MOVE MED-CONT-BASE-CUR TO KXHI-SALARY-BASE            01911440
               END-IF                                                   25991140
               MOVE XDC3-STD-DATE TO KXHI-PAY-CYCLE-END-DATE            25991140
               CALL WS-PPBENXHI                                         PPNETCLC
               IF KXHI-RETURN-STATUS-ABORTING                           PPNETCLC
                  MOVE M40988 TO KNET-MSSG-NO (1)                       PPNETCLC
                  GOBACK                                                PPNETCLC
               ELSE                                                     PPNETCLC
                MOVE KXHI-1-EMPLOYEE-DEDUCTION TO KNET-DED-TO-TAKE      PPNETCLC
                MOVE KXHI-1-EMPLOYER-CONTRIBUTION TO KNET-MC-DED-TO-TAKEPPNETCLC
      *----------> DEVELOP DOMESTIC PARTNERS TIP AND DPI AMOUNTS        32181188
                IF MED-COVERAGE-WODM NOT = SPACES                       30001947
                    SET COMPUTE-FEDERAL TO TRUE                         30001947
                    PERFORM 0701-MEDICAL-WOD                            30001947
                    MOVE WS-DP-TIP-AMT TO KNET-DP-TIP-FED-AMT           30001947
                    MOVE WS-DP-DPI-AMT TO KNET-DP-DPI-FED-AMT           30001947
                    IF STATE-DECLAR-DPI = 'Y'                           30001947
                        SET COMPUTE-CA-SDDP TO TRUE                     30001947
                    ELSE                                                30001947
                        SET COMPUTE-CA      TO TRUE                     30001947
                    END-IF                                              30001947
                    PERFORM 0701-MEDICAL-WOD                            30001947
                    MOVE WS-DP-TIP-AMT TO KNET-DP-TIP-CA-AMT            30001947
                    MOVE WS-DP-DPI-AMT TO KNET-DP-DPI-CA-AMT            30001947
                END-IF                                                  30001947
                PERFORM 9000-BEN-STATUS-CHK                             PPNETCLC
               END-IF                                                   PPNETCLC
            END-IF                                                      PPNETCLC
           END-IF.                                                      PPNETCLC
                                                                        PPNETCLC
                                                                        30001947
                                                                        30001947
       0701-MEDICAL-WOD  SECTION.                                       30001947
                                                                        30001947
           MOVE ZERO TO WS-DP-TIP-AMT.                                  30001947
           MOVE ZERO TO WS-DP-DPI-AMT.                                  30001947
           IF KNET-DP-DPI-FED-GTN > ZERO                                30001947
             AND KNET-DP-TIP-FED-GTN > ZERO                             30001947
             AND KNET-DP-DPI-CA-GTN > ZERO                              30001947
             AND KNET-DP-TIP-CA-GTN > ZERO                              30001947
               MOVE MED-COVERAGE-WODM TO KXHI-1-COVERAGE-CODE           30001947
               SET MEDICAL-BENEFIT TO TRUE                              30001947
               MOVE KNET-END-YYMMDD TO XDC3-STD-DATE                    30001947
      **** Move 1 to the day and add 1 to the month                     EFIX1998
               MOVE 01              TO XDC3-STD-DD                      EFIX1998
               IF XDC3-STD-MM = 12                                      30001947
                  MOVE 01 TO XDC3-STD-MM                                30001947
                  ADD 01 TO XDC3-STD-YY                                 30001947
               ELSE                                                     EFIX1998
                  ADD 01            TO XDC3-STD-MM                      EFIX1998
               END-IF                                                   30001947
               PERFORM XDC3-CONVERT-STD-TO-ISO                          30001947
               MOVE XDC3-ISO-DATE TO KCOV-EFFECTIVE-DATE-1              30001947
               MOVE KNET-CHECK-DATE TO XDC3-STD-DATE                    30001947
               PERFORM XDC3-CONVERT-STD-TO-ISO                          30001947
               MOVE XDC3-ISO-DATE TO KCOV-EFFECTIVE-DATE-2              30001947
               CALL WS-PPCOVRGE                                         30001947
                 USING PPCOVRGE-INTERFACE,                              30001947
                       DEP-DATA-ARRAY                                   30001947
               IF KCOV-NORMAL                                           30001947
                   IF KCOV-COV-CODE-WOD = SPACES                        30001947
                       MOVE HLTH-COVERCODE                              30001947
                         TO KCOV-COV-CODE-WOD                           30001947
                   ELSE                                                 30001947
                   IF HLTH-COVERCODE (1:1) NOT = SPACE                  30001947
                     AND KCOV-COV-CODE-WOD (1:1) NOT = SPACE            30001947
                       MOVE HLTH-COVERCODE (1:1)                        30001947
                         TO KCOV-COV-CODE-WOD (1:1)                     30001947
                   END-IF                                               30001947
                   IF HLTH-COVERCODE (2:1) NOT = SPACE                  30001947
                     AND KCOV-COV-CODE-WOD (2:1) NOT = SPACE            30001947
                       IF HLTH-COVERCODE (2:1) = 'M'                    30001947
                           MOVE HLTH-COVERCODE (2:1)                    30001947
                             TO KCOV-COV-CODE-WOD (2:1)                 30001947
                       END-IF                                           30001947
                   END-IF                                               30001947
                   IF HLTH-COVERCODE (3:1) NOT = SPACE                  30001947
                     AND KCOV-COV-CODE-WOD (3:1) NOT = SPACE            30001947
                       IF HLTH-COVERCODE (3:1) = 'M'                    30001947
                           MOVE HLTH-COVERCODE (3:1)                    30001947
                             TO KCOV-COV-CODE-WOD (3:1)                 30001947
                       END-IF                                           30001947
                   END-IF                                               30001947
                   END-IF                                               30001947
                   MOVE KCOV-COV-CODE-WOD TO KXHI-1-COVERAGE-CODE       30001947
               ELSE                                                     30001947
                   MOVE MED-COVERAGE-WODM TO KXHI-1-COVERAGE-CODE       30001947
               END-IF                                                   30001947
               INSPECT KXHI-1-COVERAGE-CODE                             30001947
                 REPLACING  ALL 'X'  BY ' '                             30001947
               INSPECT KXHI-1-COVERAGE-CODE                             30001947
                 REPLACING  ALL 'Y'  BY ' '                             30001947
               IF KXHI-1-COVERAGE-CODE (2:1) = ' '                      30001947
                   MOVE KXHI-1-COVERAGE-CODE (3:1)                      30001947
                     TO KXHI-1-COVERAGE-CODE (2:1)                      30001947
                   MOVE ' ' TO KXHI-1-COVERAGE-CODE (3:1)               30001947
               END-IF                                                   30001947
               CALL WS-PPBENXHI                                         30001947
               IF KXHI-RETURN-STATUS-ABORTING                           30001947
                   MOVE M40988 TO KNET-MSSG-NO (1)                      30001947
                   GOBACK                                               30001947
               ELSE                                                     30001947
                   COMPUTE WS-DP-TIP-AMT  = KNET-DED-TO-TAKE            30001947
                                     - KXHI-1-EMPLOYEE-DEDUCTION        30001947
                   COMPUTE WS-DP-DPI-AMT  = KNET-MC-DED-TO-TAKE         30001947
                                     - KXHI-1-EMPLOYER-CONTRIBUTION     30001947
                   IF  WS-DP-DPI-AMT  < ZERO                            30001947
                    OR WS-DP-TIP-AMT  < ZERO                            30001947
                       MOVE ZERO  TO WS-DP-DPI-AMT                      30001947
                       MOVE ZERO  TO WS-DP-TIP-AMT                      30001947
                   END-IF                                               30001947
               END-IF                                                   30001947
           END-IF.                                                      30001947
                                                                        30001947
                                                                        30001947
       0800-DENTAL-CALC SECTION.                                        PPNETCLC
                                                                        PPNETCLC
           IF XGTN-BENEFIT-TYPE = 'D'                                   PPNETCLC
            IF XGTN-BENEFIT-PLAN = DENTAL-PLAN                          PPNETCLC
               MOVE DENTAL-COVEFFDATE TO KXDI-COVERAGE-EFFECT-DATE      28521025
               MOVE DENTAL-PLAN TO KXDI-PLAN-CODE                       PPNETCLC
               MOVE DENTAL-COVERAGE TO KXDI-COVERAGE-CODE               PPNETCLC
               MOVE KNET-DED-BRSC-ARRAY TO KXDI-BRSC                    PPNETCLC
               MOVE KNET-END-YYMMDD TO XDC3-STD-DATE                    25991140
               IF XDC3-STD-MM = 12                                      25991140
                  MOVE 01 TO XDC3-STD-MM                                25991140
                  ADD 01 TO XDC3-STD-YY                                 25991140
               END-IF                                                   25991140
               MOVE XDC3-STD-DATE TO KXDI-PAY-CYCLE-END-DATE            25991140
               CALL WS-PPBENXDI                                         PPNETCLC
               IF KXDI-RETURN-STATUS-ABORTING                           PPNETCLC
                   MOVE M40987 TO KNET-MSSG-NO (1)                      PPNETCLC
                   GOBACK                                               PPNETCLC
               ELSE                                                     PPNETCLC
                  MOVE KXDI-EMPLOYEE-DEDUCTION TO KNET-DED-TO-TAKE      PPNETCLC
                  MOVE KXDI-EMPLOYER-CONTRIBUTION TO KNET-MC-DED-TO-TAKEPPNETCLC
      *----------> DEVELOP DOMESTIC PARTNERS TIP AND DPI AMOUNTS        32181188
                  IF DEN-COVERAGE-WODD NOT = SPACES                     30001947
                      SET COMPUTE-FEDERAL TO TRUE                       30001947
                      PERFORM 0801-DENTAL-WOD                           30001947
                      MOVE WS-DP-TIP-AMT TO KNET-DP-TIP-FED-AMT         30001947
                      MOVE WS-DP-DPI-AMT TO KNET-DP-DPI-FED-AMT         30001947
                      IF STATE-DECLAR-DPI = 'Y'                         30001947
                          SET COMPUTE-CA-SDDP TO TRUE                   30001947
                      ELSE                                              30001947
                          SET COMPUTE-CA      TO TRUE                   30001947
                      END-IF                                            30001947
                      PERFORM 0801-DENTAL-WOD                           30001947
                      MOVE WS-DP-TIP-AMT TO KNET-DP-TIP-CA-AMT          30001947
                      MOVE WS-DP-DPI-AMT TO KNET-DP-DPI-CA-AMT          30001947
                  END-IF                                                30001947
                  PERFORM 9000-BEN-STATUS-CHK                           PPNETCLC
                  IF KXDI-RETURN-STATUS-FLAG = '2'                      PPNETCLC
                     MOVE M40111 TO KNET-MSSG-NO (1)                    PPNETCLC
                  END-IF                                                PPNETCLC
               END-IF                                                   PPNETCLC
            END-IF                                                      PPNETCLC
           END-IF.                                                      PPNETCLC
                                                                        PPNETCLC
                                                                        30001947
       0801-DENTAL-WOD  SECTION.                                        30001947
                                                                        30001947
           MOVE ZERO TO WS-DP-TIP-AMT.                                  30001947
           MOVE ZERO TO WS-DP-DPI-AMT.                                  30001947
           IF KNET-DP-DPI-FED-GTN > ZERO                                30001947
             AND KNET-DP-TIP-FED-GTN > ZERO                             30001947
             AND KNET-DP-DPI-CA-GTN > ZERO                              30001947
             AND KNET-DP-TIP-CA-GTN > ZERO                              30001947
               MOVE DEN-COVERAGE-WODD TO KXDI-COVERAGE-CODE             30001947
               SET DENTAL-BENEFIT TO TRUE                               30001947
               MOVE KNET-END-YYMMDD TO XDC3-STD-DATE                    30001947
      **** Move 1 to the day and add 1 to the month                     EFIX1998
               MOVE 01              TO XDC3-STD-DD                      EFIX1998
               IF XDC3-STD-MM = 12                                      30001947
                  MOVE 01 TO XDC3-STD-MM                                30001947
                  ADD 01 TO XDC3-STD-YY                                 30001947
               ELSE                                                     EFIX1998
                  ADD 01            TO XDC3-STD-MM                      EFIX1998
               END-IF                                                   30001947
               PERFORM XDC3-CONVERT-STD-TO-ISO                          30001947
               MOVE XDC3-ISO-DATE TO KCOV-EFFECTIVE-DATE-1              30001947
               MOVE KNET-CHECK-DATE TO XDC3-STD-DATE                    30001947
               PERFORM XDC3-CONVERT-STD-TO-ISO                          30001947
               MOVE XDC3-ISO-DATE TO KCOV-EFFECTIVE-DATE-2              30001947
               CALL WS-PPCOVRGE                                         30001947
                 USING PPCOVRGE-INTERFACE,                              30001947
                       DEP-DATA-ARRAY                                   30001947
               IF KCOV-NORMAL                                           30001947
                   IF KCOV-COV-CODE-WOD = SPACES                        30001947
                       MOVE DENTAL-COVERAGE TO KCOV-COV-CODE-WOD        30001947
                   END-IF                                               30001947
                   MOVE KCOV-COV-CODE-WOD TO KXDI-COVERAGE-CODE         30001947
               ELSE                                                     30001947
                   MOVE DEN-COVERAGE-WODD TO KXDI-COVERAGE-CODE         30001947
               END-IF                                                   30001947
               INSPECT KXDI-COVERAGE-CODE                               30001947
                 REPLACING  ALL 'X'  BY ' '                             30001947
               INSPECT KXDI-COVERAGE-CODE                               30001947
                 REPLACING  ALL 'Y'  BY ' '                             30001947
               IF KXDI-COVERAGE-CODE (2:1) = ' '                        30001947
                   MOVE KXDI-COVERAGE-CODE (3:1)                        30001947
                     TO KXDI-COVERAGE-CODE (2:1)                        30001947
                   MOVE ' ' TO KXDI-COVERAGE-CODE (3:1)                 30001947
               END-IF                                                   30001947
               CALL WS-PPBENXDI                                         30001947
               IF KXDI-RETURN-STATUS-ABORTING                           30001947
                   MOVE M40987 TO KNET-MSSG-NO (1)                      30001947
                   GOBACK                                               30001947
               ELSE                                                     30001947
                   COMPUTE WS-DP-TIP-AMT  = KNET-DED-TO-TAKE            30001947
                                     - KXDI-EMPLOYEE-DEDUCTION          30001947
                   COMPUTE WS-DP-DPI-AMT  = KNET-MC-DED-TO-TAKE         30001947
                                     - KXDI-EMPLOYER-CONTRIBUTION       30001947
                   IF  WS-DP-DPI-AMT  < ZERO                            30001947
                    OR WS-DP-TIP-AMT  < ZERO                            30001947
                       MOVE ZERO  TO WS-DP-DPI-AMT                      30001947
                       MOVE ZERO  TO WS-DP-TIP-AMT                      30001947
                   END-IF                                               30001947
               END-IF                                                   30001947
           END-IF.                                                      30001947
                                                                        PPNETCLC
                                                                        PPNETCLC
       0900-ADD-CALC SECTION.                                           PPNETCLC
                                                                        PPNETCLC
           MOVE ADD-COVEFFDATE TO KADD-COVERAGE-EFFECT-DATE.            28521025
           MOVE ADD-PRINC-SUM TO KADD-PRINCIPAL-SUM.                    PPNETCLC
           MOVE ADD-COVERAGE TO KADD-COVERAGE-CODE.                     PPNETCLC
           MOVE KNET-DED-BRSC-ARRAY TO KADD-BRSC.                       PPNETCLC
           CALL WS-PPBENADD.                                            PPNETCLC
           IF KADD-RETURN-STATUS-ABORTING                               PPNETCLC
               MOVE M40981 TO KNET-MSSG-NO (1)                          PPNETCLC
               GOBACK.                                                  PPNETCLC
           IF KADD-RETURN-STATUS-FLAG = '2'                             PPNETCLC
              MOVE M40111 TO  KNET-MSSG-NO (1)                          PPNETCLC
           END-IF.                                                      PPNETCLC
           IF KADD-ENROLLED-IN-ADD                                      PPNETCLC
              MOVE KADD-EMPLOYEE-DEDUCTION TO KNET-DED-TO-TAKE          PPNETCLC
              MOVE ZERO TO KNET-MC-DED-TO-TAKE                          PPNETCLC
              PERFORM 9000-BEN-STATUS-CHK                               PPNETCLC
           END-IF.                                                      PPNETCLC
                                                                        PPNETCLC
       1000-LIFE-CALC SECTION.                                          PPNETCLC
                                                                        PPNETCLC
           IF KNET-DEDX = GROUP-LIFE-INS                                PPNETCLC
              PERFORM 1040-EMP-LIFE-CALC                                PPNETCLC
              IF KXLI-ENROLLED-IN-LIFE                                  PPNETCLC
                 MOVE KXLI-INS-PREMIUM-AMT TO KNET-DED-TO-TAKE          PPNETCLC
                 MOVE ZERO TO KNET-MC-DED-TO-TAKE                       PPNETCLC
                 PERFORM 9000-BEN-STATUS-CHK                            PPNETCLC
              END-IF                                                    PPNETCLC
           ELSE                                                         PPNETCLC
             IF KNET-DEDX = DEP-LIFE-INS                                PPNETCLC
                PERFORM 1070-DEP-LIFE-CALC                              PPNETCLC
                IF KDLI-ENROLLED-IN-DEP-LIFE                            PPNETCLC
                   MOVE KDLI-DEP-PREMIUM-AMT TO KNET-DED-TO-TAKE        PPNETCLC
                   MOVE ZERO TO KNET-MC-DED-TO-TAKE                     PPNETCLC
                   PERFORM 9000-BEN-STATUS-CHK                          PPNETCLC
                END-IF                                                  PPNETCLC
             END-IF                                                     PPNETCLC
           END-IF.                                                      PPNETCLC
                                                                        PPNETCLC
       1040-EMP-LIFE-CALC SECTION.                                      PPNETCLC
                                                                        PPNETCLC
           MOVE AGE-JAN1 TO KXLI-LI-EMP-AGE.                            PPNETCLC
           MOVE LIFE-SALARY-BASE TO KXLI-LI-BASE-SALARY.                PPNETCLC
           MOVE LIFEINS-PLAN TO KXLI-PLAN-CODE.                         PPNETCLC
           MOVE LIFE-COVEFFDATE  TO KXLI-COVERAGE-EFFECT-DATE.          28521025
           MOVE KNET-DED-BRSC-ARRAY TO KXLI-BRSC.                       PPNETCLC
           CALL WS-PPBENXLI.                                            PPNETCLC
           IF KXLI-RETURN-STATUS-ABORTING                               PPNETCLC
               MOVE M40989 TO KNET-MSSG-NO (1)                          PPNETCLC
               GOBACK.                                                  PPNETCLC
           IF KXLI-RETURN-STATUS-FLAG = '2'                             PPNETCLC
              MOVE M40111 TO  KNET-MSSG-NO (1).                         PPNETCLC
                                                                        PPNETCLC
       1070-DEP-LIFE-CALC SECTION.                                      PPNETCLC
                                                                        PPNETCLC
           MOVE AGE-JAN1         TO KDLI-LI-EMP-AGE.                    PPNETCLC
           MOVE DEP-LIFE-IND     TO KDLI-DEP-PLAN-CODE.                 PPNETCLC
           MOVE LIFEINS-PLAN     TO KDLI-EMP-LIFE-PLAN-CODE.            PPNETCLC
           MOVE LIFE-SALARY-BASE TO KDLI-EMP-LIFE-SALARY-BASE.          PPNETCLC
           MOVE EXEC-LIFEFLAG    TO KDLI-EXEC-LIFE-PLAN-CODE.           PPNETCLC
           MOVE EXEC-LIFESALARY  TO KDLI-EXEC-LIFE-SALARY-BASE.         PPNETCLC
           MOVE DEPLIFE-COVEFFDATE TO KDLI-COVERAGE-EFFECT-DATE.        28521025
           MOVE KNET-DED-BRSC-ARRAY TO KDLI-BRSC                        PPNETCLC
           CALL WS-PPBENDLI.                                            PPNETCLC
           IF KDLI-RETURN-STATUS-ABORTING                               PPNETCLC
               MOVE M40994 TO KNET-MSSG-NO (1)                          PPNETCLC
               GOBACK                                                   PPNETCLC
           ELSE                                                         PPNETCLC
             IF KDLI-RETURN-STATUS-FLAG = '2'                           PPNETCLC
                MOVE M40111 TO  KNET-MSSG-NO (1)                        PPNETCLC
             END-IF                                                     PPNETCLC
           END-IF.                                                      PPNETCLC
                                                                        PPNETCLC
       1200-EPD-CALC SECTION.                                           PPNETCLC
                                                                        PPNETCLC
           MOVE AGE-JAN1 TO KEPD-EMPLOYEE-AGE.                          PPNETCLC
           MOVE EPD-SALARY-BASE  TO KEPD-SALARY-BASE.                   PPNETCLC
           MOVE EPD-COVRGE-DATE  TO KEPD-COVERAGE-EFFECT-DATE.          28521025
           MOVE EPD-WAIT-PERIOD    TO KEPD-WAIT-PERIOD.                 PPNETCLC
           MOVE KNET-DED-BRSC-ARRAY TO KEPD-BRSC.                       PPNETCLC
           MOVE RET-ELIG-CODE  TO KEPD-RET-ELIG-CODE.                   36362075
           CALL WS-PPBENEPD.                                            PPNETCLC
           IF KEPD-RETURN-STATUS-ABORTING                               PPNETCLC
               MOVE M40995 TO KNET-MSSG-NO (1)                          PPNETCLC
               GOBACK.                                                  PPNETCLC
           IF KEPD-RETURN-STATUS-FLAG = '2'                             PPNETCLC
              MOVE M40111 TO  KNET-MSSG-NO (1)                          PPNETCLC
           END-IF.                                                      PPNETCLC
           IF KEPD-ENROLLED-IN-EPD                                      PPNETCLC
               MOVE KEPD-TOTAL-PREMIUM   TO KNET-DED-TO-TAKE            PPNETCLC
               MOVE ZERO TO KNET-MC-DED-TO-TAKE                         PPNETCLC
               PERFORM 9000-BEN-STATUS-CHK                              PPNETCLC
           END-IF.                                                      PPNETCLC
                                                                        PPNETCLC
       1300-DISABILITY-CALC   SECTION.                                  13872234
                                                                        13872234
           MOVE AGE-JAN1 TO KDIS-EMPLOYEE-AGE.                          13872234
           MOVE EPD-SALARY-BASE  TO KDIS-SALARY-BASE.                   13872234
                                                                        13872234
           MOVE KNET-DED-BRSC-ARRAY TO KDIS-BRSC.                       13872234
           MOVE RET-ELIG-CODE  TO KDIS-RET-ELIG-CODE.                   13872234
                                                                        13872234
           IF KNET-CUR-CODE = IC2-STD-DIS-GTN                           13872234
              SET KDIS-SHORT-TERM-DISABILITY TO TRUE                    13872234
              MOVE STD-EARNEFFDATE  TO KDIS-COV-EFFECT-DATE             13872234
              MOVE STD-WAITPERIOD   TO KDIS-WAIT-PERIOD                 13872234
           ELSE                                                         13872234
              SET KDIS-LONG-TERM-DISABILITY TO TRUE                     13872234
              MOVE EPD-COVRGE-DATE  TO KDIS-COV-EFFECT-DATE             13872234
              MOVE EPD-WAIT-PERIOD  TO KDIS-WAIT-PERIOD                 13872234
           END-IF.                                                      13872234
                                                                        13872234
           CALL WS-PPBENDIS.                                            13872234
           IF KDIS-RETURN-STATUS-ABORTING                               13872234
               MOVE M40995 TO KNET-MSSG-NO (1)                          13872234
               GOBACK                                                   13872234
           END-IF.                                                      13872234
                                                                        13872234
           IF KDIS-RETURN-STATUS-FLAG = '2'                             13872234
              MOVE M40111 TO  KNET-MSSG-NO (1)                          13872234
           END-IF.                                                      13872234
                                                                        13872234
           IF KDIS-ENROLLED-IN-DIS                                      13872234
               MOVE KDIS-TOTAL-PREMIUM   TO KNET-DED-TO-TAKE            13872234
               MOVE ZERO TO KNET-MC-DED-TO-TAKE                         13872234
               PERFORM 9000-BEN-STATUS-CHK                              13872234
           END-IF.                                                      13872234
                                                                        13872234
       1300-EXIT.                                                       13872234
           EXIT.                                                        13872234
                                                                        13872234
       1500-MONTHLY-CAP-CALC SECTION.                                   PPNETCLC
                                                                        PPNETCLC
                                                                        71921294
           IF XGTN-USAGE = 'B' OR '1' OR 'F'                            71921294
              IF KNET-CALC15-BASE  > ZERO                               71921294
                 MOVE KNET-CALC15-RATE TO KNET-DED-TO-TAKE              71921294
              ELSE                                                      71921294
      *---------> FOR FIXED AMOUNT CALC 15 DEDUCTIONS, IF NO EARNINGS/  71921294
      *---------> HOURS REPORTED, BYPASS THE DEDUCTION                  71921294
                 MOVE ZERO             TO KNET-DED-TO-TAKE              71921294
           ELSE                                                         71921294
              IF XGTN-USAGE = 'R'  OR '2' OR 'P'                        71921294
                 COMPUTE KNET-WRKPCT = KNET-CALC15-RATE / 100           71921294
                 COMPUTE KNET-DED-TO-TAKE ROUNDED                       71921294
                       = KNET-WRKPCT * KNET-CALC15-BASE                 71921294
              ELSE                                                      71921294
                 IF XGTN-USAGE = 'T' OR 'H' OR '3'                      71921294
                    COMPUTE KNET-WRKPCT = KNET-CALC15-RATE / 100        71921294
                    COMPUTE KNET-DED-TO-TAKE ROUNDED                    71921294
                          = KNET-WRKPCT * KNET-CALC15-BASE              71921294
                 END-IF                                                 71921294
              END-IF                                                    71921294
           END-IF.                                                      71921294
                                                                        48071211
       1600-PARKING-CAP-CALC  SECTION.                                  48071211
                                                                        48071211
           IF  KNET-DED-BALAMT-GTN > ZERO                               48071211
               MOVE +1 TO LIM-SUB                                       48071211
               PERFORM 1610-CLEAR-GENERIC-GTN-TABLE                     48071211
               MOVE KNET-DED-BALAMT-GTN TO WS-KNET-DED-GTN-HOLD         48071211
                                                                        48071211
               PERFORM 1650-BUILD-DEDUCT-FROM-USAGE                     48071211
               IF KNET-HALVE-AMT                                        48071211
                  PERFORM 1680-HALVE-DED                                48071211
                  SET KNET-NO-HALVING TO TRUE                           48071211
                                                                        48071211
               END-IF                                                   48071211
                                                                        48071211
      *----> FIRST FILL IN ONLY THE APPROPRIATE INITIAL GTN NUMBER      48071211
      *----> AND ITS LINKED GTN NUMBERS ON THE GENERIC TGTN TABLE       48071211
               MOVE KNET-DEDX TO GTN-DED-NUM                            48071211
               MOVE GTN-DED-NUM-CHAR  TO  WS-LAST-LINK-GTN              48071211
               PERFORM 1620-GENERIC-TGTN-TABLE                          48071211
                                                                        48071211
      *----> CALCULATE THE APPROPRIATE DEDUCTION TO TAKE  FOR EACH GTN  48071211
      *----> DOWN TO THE LIM-LINK-GTN-NUM OF '000'                      48071211
                                                                        48071211
               MOVE +1 TO LIM-SUB                                       48071211
               MOVE WS-KNET-DED-GTN-HOLD TO WS-DED-AMT-TO-TAKE-PARK     48071211
               MOVE SPACES TO WS-LAST-LINK-GTN                          48071211
               PERFORM 1640-CALC-DED-TO-TAKE-PARK                       48071211
           END-IF.                                                      48071211
                                                                        48071211
           IF KNET-HALVE-AMT                                            48071211
              SET KNET-NO-HALVING TO TRUE                               48071211
           END-IF.                                                      48071211
                                                                        48071211
           IF XDSA-BALAMT (KNET-DEDX XDSA-GTN-P) >  ZERO                48071211
               MOVE XDSA-BALAMT (KNET-DEDX XDSA-GTN-P)                  48071211
                                         TO KNET-DED-TO-TAKE            48071211
               ADD  XDSA-BALAMT (KNET-DEDX XDSA-GTN-P)                  48071211
                                         TO TGTN-PARK-RED-TAKEN         48071211
               MOVE ZERO TO XDSA-BALAMT (KNET-DEDX XDSA-GTN-P)          48071211
           END-IF.                                                      48071211
                                                                        48071211
                                                                        48071211
       1610-CLEAR-GENERIC-GTN-TABLE  SECTION.                           48071211
                                                                        48071211
           PERFORM                                                      48071211
              VARYING GTN-SUB FROM +1 BY +1                             48071211
              UNTIL     GTN-SUB > +4                                    48071211
                                                                        48071211
                  MOVE SPACES TO TGTN-LIM-NUMBER      (LIM-SUB GTN-SUB) 48071211
                              TGTN-LIM-LINK-GTN-NUM   (LIM-SUB GTN-SUB) 48071211
                              TGTN-LIM-LINK-INIT-FLAG (LIM-SUB GTN-SUB) 48071211
                                                                        48071211
           END-PERFORM.                                                 48071211
                                                                        48071211
       1620-GENERIC-TGTN-TABLE  SECTION.                                48071211
                                                                        48071211
           PERFORM                                                      48071211
              VARYING GTN-SUB FROM +1 BY +1                             48071211
              UNTIL     GTN-SUB > +4                                    48071211
              OR   WS-LAST-LINK-GTN = '000'                             48071211
                                                                        48071211
                  PERFORM 1630-SEARCH-GENERIC-TGTN-TABLE                48071211
                  IF LINK-GTN-FOUND                                     48071211
                     MOVE WS-LAST-LINK-GTN                              48071211
                             TO TGTN-LIM-NUMBER (LIM-SUB GTN-SUB)       48071211
                     MOVE TGTN-GTN-LINK-GTN-NUM (TGTN-SUB)              48071211
                             TO TGTN-LIM-LINK-GTN-NUM (LIM-SUB GTN-SUB) 48071211
                                     WS-LAST-LINK-GTN                   48071211
                     MOVE TGTN-GTN-INIT-LINK-FLAG (TGTN-SUB)            48071211
                             TO TGTN-LIM-LINK-INIT-FLAG                 48071211
                                                   (LIM-SUB GTN-SUB)    48071211
                  END-IF                                                48071211
           END-PERFORM.                                                 48071211
                                                                        48071211
                                                                        48071211
       1630-SEARCH-GENERIC-TGTN-TABLE  SECTION.                         48071211
                                                                        48071211
           SET LINK-GTN-INITIAL TO TRUE.                                48071211
                                                                        48071211
           SET TGTN-SUB TO 1.                                           48071211
           SEARCH TGTN-GTNS                                             48071211
               WHEN WS-LAST-LINK-GTN                                    48071211
                    = TGTN-GTN-NUMBER (TGTN-SUB)                        48071211
                   SET LINK-GTN-FOUND TO TRUE                           48071211
           END-SEARCH.                                                  48071211
                                                                        48071211
                                                                        48071211
                                                                        48071211
       1640-CALC-DED-TO-TAKE-PARK   SECTION.                            48071211
                                                                        48071211
           PERFORM                                                      48071211
              VARYING GTN-SUB FROM +1 BY +1                             48071211
              UNTIL  GTN-SUB > +4                                       48071211
              OR     WS-LAST-LINK-GTN = HIGH-VALUES                     48071211
                                                                        48071211
                  MOVE TGTN-LIM-NUMBER (LIM-SUB GTN-SUB)                48071211
                                          TO GTN-DED-NUM                48071211
                                                                        48071211
                  IF TGTN-LIM-REDUCTION-FWT     (LIM-SUB GTN-SUB) = 'Y' 48071211
                  OR TGTN-LIM-REDUCTION-SWT     (LIM-SUB GTN-SUB) = 'Y' 48071211
                  OR TGTN-LIM-REDUCTION-FICA    (LIM-SUB GTN-SUB) = 'Y' 48071211
                                                                        48071211
                     COMPUTE WS-CALC-AMT-TAKE                           48071211
                              = TGTN-LIM-LIMIT       (LIM-SUB GTN-SUB)  48071211
                              - TGTN-LIM-LIMIT-TAKEN (LIM-SUB GTN-SUB)  48071211
                                                                        48071211
                     IF TGTN-LIM-LIMIT-TAKEN         (LIM-SUB GTN-SUB)  48071211
                                  <  TGTN-LIM-LIMIT  (LIM-SUB GTN-SUB)  48071211
                        IF    WS-DED-AMT-TO-TAKE-PARK                   48071211
                                             NOT > WS-CALC-AMT-TAKE     48071211
                              ADD   WS-DED-AMT-TO-TAKE-PARK             48071211
                                           TO TGTN-LIM-LIMIT-TAKEN      48071211
                                                     (LIM-SUB GTN-SUB)  48071211
                              MOVE WS-DED-AMT-TO-TAKE-PARK              48071211
                                           TO XDSA-BALAMT               48071211
                                              (GTN-DED-NUM XDSA-GTN-P)  48071211
                                                                        48071211
                              COMPUTE WS-DED-AMT-TO-TAKE-PARK           48071211
                                 =  WS-DED-AMT-TO-TAKE-PARK             48071211
                                 -  XDSA-BALAMT                         48071211
                                          (GTN-DED-NUM XDSA-GTN-P)      48071211
                        ELSE                                            48071211
                           ADD  WS-CALC-AMT-TAKE                        48071211
                                        TO TGTN-LIM-LIMIT-TAKEN         48071211
                                                     (LIM-SUB GTN-SUB)  48071211
                           MOVE WS-CALC-AMT-TAKE                        48071211
                                        TO XDSA-BALAMT                  48071211
                                              (GTN-DED-NUM XDSA-GTN-P)  48071211
                                                                        48071211
                           COMPUTE WS-DED-AMT-TO-TAKE-PARK              48071211
                                   =  WS-DED-AMT-TO-TAKE-PARK           48071211
                                   -  WS-CALC-AMT-TAKE                  48071211
                                                                        48071211
                        END-IF                                          48071211
                     END-IF                                             48071211
                  END-IF                                                48071211
                                                                        48071211
                  IF TGTN-LIM-LINK-GTN-NUM (LIM-SUB GTN-SUB) = '000'    48071211
                      MOVE HIGH-VALUES TO WS-LAST-LINK-GTN              48071211
                      IF WS-DED-AMT-TO-TAKE-PARK  >  ZERO               48071211
                         ADD WS-DED-AMT-TO-TAKE-PARK                    48071211
                                    TO  TGTN-LIM-LIMIT-TAKEN            48071211
                                                   (LIM-SUB GTN-SUB)    48071211
                         MOVE WS-DED-AMT-TO-TAKE-PARK                   48071211
                                    TO XDSA-BALAMT                      48071211
                                          (GTN-DED-NUM XDSA-GTN-P)      48071211
                                                                        48071211
                      END-IF                                            48071211
                  ELSE                                                  48071211
                      MOVE TGTN-LIM-LINK-GTN-NUM (LIM-SUB GTN-SUB)      48071211
                                    TO WS-LAST-LINK-GTN                 48071211
                  END-IF                                                48071211
                                                                        48071211
           END-PERFORM.                                                 48071211
                                                                        48071211
       1650-BUILD-DEDUCT-FROM-USAGE  SECTION.                           48071211
                                                                        48071211
           EVALUATE XGTN-USAGE                                          48071211
            WHEN 'F'                                                    48071211
                 MOVE KNET-DED-BALAMT-GTN TO WS-KNET-DED-GTN-HOLD       48071211
            WHEN '1'                                                    48071211
                 MOVE KNET-DED-PARAMETER  TO WS-KNET-DED-GTN-HOLD       48071211
            WHEN '2'                                                    48071211
                 MOVE KNET-DED-PARAMETER TO KNET-WRKPCT                 48071211
                 COMPUTE KNET-WRKPCT = KNET-WRKPCT / 100                48071211
                 PERFORM 1660-CALC-RATE-FROM-BASE                       48071211
            WHEN '3'                                                    48071211
                 MOVE KNET-DED-PARAMETER TO KNET-WRKPCT                 48071211
                 COMPUTE KNET-WRKPCT = KNET-WRKPCT / 100                48071211
                 PERFORM 1670-CALC-RATE-FROM-HOURS                      48071211
            WHEN 'P'                                                    48071211
                 MOVE WS-KNET-DED-GTN-HOLD TO KNET-WRKPCT               48071211
                 COMPUTE KNET-WRKPCT = KNET-WRKPCT / 100                48071211
                 PERFORM 1660-CALC-RATE-FROM-BASE                       48071211
            WHEN 'H'                                                    48071211
                 MOVE WS-KNET-DED-GTN-HOLD TO KNET-WRKPCT               48071211
                 COMPUTE KNET-WRKPCT = KNET-WRKPCT / 100                48071211
                 PERFORM 1670-CALC-RATE-FROM-HOURS                      48071211
           END-EVALUATE.                                                48071211
                                                                        48071211
           IF XGTN-USAGE = 'B' OR 'R' OR 'T'                            48071211
             IF XGTN-USAGE = 'B'                                        48071211
                ADD KNET-BRT-RATE TO WS-KNET-DED-GTN-HOLD               48071211
             ELSE                                                       48071211
                MOVE KNET-BRT-RATE TO KNET-WRKPCT                       48071211
                COMPUTE KNET-WRKPCT = KNET-WRKPCT / 100                 48071211
                IF XGTN-USAGE = 'R'                                     48071211
                   PERFORM 1660-CALC-RATE-FROM-BASE                     48071211
                ELSE                                                    48071211
                   PERFORM 1670-CALC-RATE-FROM-HOURS                    48071211
                END-IF                                                  48071211
             END-IF                                                     48071211
           END-IF.                                                      48071211
                                                                        48071211
       1660-CALC-RATE-FROM-BASE  SECTION.                               48071211
                                                                        48071211
           MOVE ZEROS TO KNET-BASE.                                     48071211
           MOVE KNET-REDUCTIONS-FWT TO REDUCTION-WK-AMT.                48071211
           EVALUATE XGTN-BASE                                           48071211
            WHEN 'T'                                                    48071211
                MOVE KNET-TOTAL-GROSS TO KNET-BASE                      48071211
            WHEN 'W'                                                    48071211
                MOVE KNET-FWT-GROSS TO KNET-BASE                        48071211
            WHEN 'F'                                                    48071211
                MOVE KNET-OASDI-GROSS TO KNET-BASE                      48071211
                MOVE KNET-REDUCTIONS-FICA TO REDUCTION-WK-AMT           48071211
            WHEN 'S'                                                    48071211
                MOVE KNET-STATE-GROSS TO KNET-BASE                      48071211
                MOVE KNET-REDUCTIONS-SWT TO REDUCTION-WK-AMT            48071211
            WHEN 'Z'                                                    48071211
                MOVE KNET-Z-GROSS TO KNET-BASE                          48071211
            WHEN 'R'                                                    48071211
                MOVE KNET-RETR-GROSS TO KNET-BASE                       48071211
           END-EVALUATE.                                                48071211
           IF XGTN-REDUCE-BASE = 'R'                                    48071211
              COMPUTE KNET-BASE = KNET-BASE - REDUCTION-WK-AMT          48071211
              IF KNET-BASE < ZEROS                                      48071211
                 MOVE ZEROS TO KNET-BASE                                48071211
              END-IF                                                    48071211
           END-IF.                                                      48071211
                                                                        48071211
           COMPUTE WS-KNET-DED-GTN-HOLD                                 48071211
                                    ROUNDED = KNET-BASE * KNET-WRKPCT.  48071211
                                                                        48071211
       1670-CALC-RATE-FROM-HOURS    SECTION.                            48071211
                                                                        48071211
           IF  XGTN-BASE = 'G'                                          48071211
               COMPUTE  KNET-BASE  = KNET-REG-HRS                       48071211
           ELSE                                                         48071211
               COMPUTE  KNET-BASE  = KNET-REG-HRS + KNET-OT-HRS         48071211
           END-IF.                                                      48071211
                                                                        48071211
           COMPUTE WS-KNET-DED-GTN-HOLD                                 48071211
                                    ROUNDED = KNET-BASE * KNET-WRKPCT.  48071211
                                                                        48071211
       1680-HALVE-DED  SECTION.                                         48071211
                                                                        48071211
           IF   (XGTN-GROUP = 'R' OR 'M' OR 'I' OR 'U')                 48071211
            AND (XGTN-USAGE = 'F' OR '1' OR 'B')                        48071211
             IF KNET-CYCLE-DEDN-SCHED = 1                               48071211
                COMPUTE WS-KNET-DED-GTN-HOLD ROUNDED                    48071211
                       = WS-KNET-DED-GTN-HOLD / 2                       48071211
             ELSE                                                       48071211
                COMPUTE WS-KNET-DED-GTN-HOLD                            48071211
                       = WS-KNET-DED-GTN-HOLD / 2                       48071211
             END-IF                                                     48071211
           END-IF.                                                      48071211
                                                                        48071211
       1700-TRANSIT-CAP-CALC  SECTION.                                  48071211
                                                                        48071211
           IF  KNET-DED-BALAMT-GTN > ZERO                               48071211
               MOVE +2 TO LIM-SUB                                       48071211
               PERFORM 1610-CLEAR-GENERIC-GTN-TABLE                     48071211
               MOVE KNET-DED-BALAMT-GTN TO WS-KNET-DED-GTN-HOLD         48071211
                                                                        48071211
               PERFORM 1650-BUILD-DEDUCT-FROM-USAGE                     48071211
               IF KNET-HALVE-AMT                                        48071211
                  PERFORM 1680-HALVE-DED                                48071211
                  SET KNET-NO-HALVING TO TRUE                           48071211
                                                                        48071211
               END-IF                                                   48071211
                                                                        48071211
      *----> FIRST FILL IN ONLY THE APPROPRIATE INITIAL GTN NUMBER      48071211
      *----> AND ITS LINKED GTN NUMBERS ON THE GENERIC TGTN TABLE       48071211
               MOVE KNET-DEDX TO GTN-DED-NUM                            48071211
               MOVE GTN-DED-NUM-CHAR  TO  WS-LAST-LINK-GTN              48071211
               PERFORM 1620-GENERIC-TGTN-TABLE                          48071211
                                                                        48071211
      *----> CALCULATE THE APPROPRIATE DEDUCTION TO TAKE  FOR EACH GTN  48071211
      *----> DOWN TO THE LIM-LINK-GTN-NUM OF '000'                      48071211
                                                                        48071211
               MOVE +2 TO LIM-SUB                                       48071211
               MOVE WS-KNET-DED-GTN-HOLD TO WS-DED-AMT-TO-TAKE-TRAN     48071211
               MOVE SPACES TO WS-LAST-LINK-GTN                          48071211
               PERFORM 1740-CALC-DED-TO-TAKE-TRAN                       48071211
           END-IF.                                                      48071211
                                                                        48071211
           IF KNET-HALVE-AMT                                            48071211
              SET KNET-NO-HALVING TO TRUE                               48071211
           END-IF.                                                      48071211
                                                                        48071211
           IF XDSA-BALAMT (KNET-DEDX XDSA-GTN-P) >  ZERO                48071211
               MOVE XDSA-BALAMT (KNET-DEDX XDSA-GTN-P)                  48071211
                                         TO KNET-DED-TO-TAKE            48071211
               ADD  XDSA-BALAMT (KNET-DEDX XDSA-GTN-P)                  48071211
                                         TO TGTN-TRAN-RED-TAKEN         48071211
               MOVE ZERO TO XDSA-BALAMT (KNET-DEDX XDSA-GTN-P)          48071211
           END-IF.                                                      48071211
                                                                        48071211
                                                                        48071211
       1740-CALC-DED-TO-TAKE-TRAN   SECTION.                            48071211
                                                                        48071211
           PERFORM                                                      48071211
              VARYING GTN-SUB FROM +1 BY +1                             48071211
              UNTIL  GTN-SUB > +4                                       48071211
              OR     WS-LAST-LINK-GTN = HIGH-VALUES                     48071211
                                                                        48071211
                  MOVE TGTN-LIM-NUMBER (LIM-SUB GTN-SUB)                48071211
                                          TO GTN-DED-NUM                48071211
                                                                        48071211
                  IF TGTN-LIM-REDUCTION-FWT     (LIM-SUB GTN-SUB) = 'Y' 48071211
                  OR TGTN-LIM-REDUCTION-SWT     (LIM-SUB GTN-SUB) = 'Y' 48071211
                  OR TGTN-LIM-REDUCTION-FICA    (LIM-SUB GTN-SUB) = 'Y' 48071211
                                                                        48071211
                     COMPUTE WS-CALC-AMT-TAKE                           48071211
                              = TGTN-LIM-LIMIT       (LIM-SUB GTN-SUB)  48071211
                              - TGTN-LIM-LIMIT-TAKEN (LIM-SUB GTN-SUB)  48071211
                                                                        48071211
                     IF TGTN-LIM-LIMIT-TAKEN         (LIM-SUB GTN-SUB)  48071211
                             < TGTN-LIM-LIMIT        (LIM-SUB GTN-SUB)  48071211
                        IF    WS-DED-AMT-TO-TAKE-TRAN                   48071211
                                             NOT > WS-CALC-AMT-TAKE     48071211
                              ADD   WS-DED-AMT-TO-TAKE-TRAN             48071211
                                       TO TGTN-LIM-LIMIT-TAKEN          48071211
                                                     (LIM-SUB GTN-SUB)  48071211
                              MOVE WS-DED-AMT-TO-TAKE-TRAN              48071211
                                       TO XDSA-BALAMT                   48071211
                                          (GTN-DED-NUM XDSA-GTN-P)      48071211
                                                                        48071211
                              COMPUTE WS-DED-AMT-TO-TAKE-TRAN           48071211
                                 =  WS-DED-AMT-TO-TAKE-TRAN             48071211
                                 -  XDSA-BALAMT                         48071211
                                          (GTN-DED-NUM XDSA-GTN-P)      48071211
                        ELSE                                            48071211
                           ADD  WS-CALC-AMT-TAKE                        48071211
                                       TO TGTN-LIM-LIMIT-TAKEN          48071211
                                                     (LIM-SUB GTN-SUB)  48071211
                           MOVE WS-CALC-AMT-TAKE                        48071211
                                       TO XDSA-BALAMT                   48071211
                                          (GTN-DED-NUM XDSA-GTN-P)      48071211
                                                                        48071211
                           COMPUTE WS-DED-AMT-TO-TAKE-TRAN              48071211
                                   =  WS-DED-AMT-TO-TAKE-TRAN           48071211
                                   -  WS-CALC-AMT-TAKE                  48071211
                                                                        48071211
                        END-IF                                          48071211
                     END-IF                                             48071211
                  END-IF                                                48071211
                                                                        48071211
                  IF TGTN-LIM-LINK-GTN-NUM (LIM-SUB GTN-SUB) = '000'    48071211
                      MOVE HIGH-VALUES TO WS-LAST-LINK-GTN              48071211
                      IF WS-DED-AMT-TO-TAKE-TRAN  >  ZERO               48071211
                         ADD WS-DED-AMT-TO-TAKE-TRAN                    48071211
                                    TO  TGTN-LIM-LIMIT-TAKEN            48071211
                                                   (LIM-SUB GTN-SUB)    48071211
                         MOVE WS-DED-AMT-TO-TAKE-TRAN                   48071211
                                    TO XDSA-BALAMT                      48071211
                                          (GTN-DED-NUM XDSA-GTN-P)      48071211
                                                                        48071211
                      END-IF                                            48071211
                  ELSE                                                  48071211
                      MOVE TGTN-LIM-LINK-GTN-NUM (LIM-SUB GTN-SUB)      48071211
                                    TO WS-LAST-LINK-GTN                 48071211
                  END-IF                                                48071211
                                                                        48071211
           END-PERFORM.                                                 48071211
                                                                        48071211
                                                                        PPNETCLC
       2000-MED-OASDI-CALC SECTION.                                     PPNETCLC
                                                                        PPNETCLC
           MOVE ZERO                 TO KNET-DED-TO-TAKE.               PPNETCLC
           MOVE KNET-DEDX            TO XFIC-FICA-DED-TYPE-CD           PPNETCLC
           MOVE KNET-REDUCTIONS-FICA TO XFIC-REDUCTIONS-FICA.           PPNETCLC
           MOVE FICA-ELIG-CODE       TO XFIC-FICA-ELIG-CODE.            PPNETCLC
           IF KNET-DEDX      = MEDICARE                                 PPNETCLC
              MOVE KNET-MAX-MEDICR-GROSS    TO XFIC-MAX-MED-GRS         PPNETCLC
              MOVE KNET-MED-BALAMT-YTD      TO XFIC-YTD-MED-DED         PPNETCLC
              MOVE KNET-MED-RATE            TO XFIC-MED-RATE            PPNETCLC
              MOVE YTD-MED-GROSS            TO XFIC-YTD-MED-GRS         PPNETCLC
              MOVE KNET-GROSS-MEDICR        TO XFIC-PAR-MED-GRS         PPNETCLC
              CALL WS-PPFICA USING  PPFICA-INTERFACE-DATA               PPNETCLC
              MOVE XFIC-YTD-MED-GRS         TO YTD-MED-GROSS            PPNETCLC
              MOVE XFIC-PAR-MED-GRS         TO KNET-GROSS-MEDICR        PPNETCLC
              MOVE XFIC-MED-DED-TO-TAKE     TO KNET-DED-TO-TAKE         PPNETCLC
              IF XFIC-YTD-MED-GRS-ADJ  NOT = ZERO                       PPNETCLC
                 MOVE 1                    TO KNET-DOLLAR-ADJ-CNT       PPNETCLC
                 MOVE SPACES               TO KNET-DOLLAR-ADJ (1)       PPNETCLC
                 MOVE XFIC-YTD-MED-GRS-ADJ TO KNET-ADJ-AMT (1)          PPNETCLC
                 MOVE MED-GRS-YTD-ELMT     TO KNET-ADJ-ELMT (1)         PPNETCLC
              END-IF                                                    PPNETCLC
           ELSE                                                         PPNETCLC
             IF KNET-DEDX      = OASDI                                  PPNETCLC
                MOVE KNET-OASDI-BALAMT-YTD  TO XFIC-YTD-OASDI-DED       PPNETCLC
                MOVE KNET-OASDI-MAX-TAXABLE TO XFIC-MAX-OASDI-GRS       PPNETCLC
                MOVE KNET-OASDI-PERCENT     TO XFIC-OASDI-RATE-PRCNT    PPNETCLC
                MOVE YTD-OASDI-GROSS        TO XFIC-YTD-OASDI-GRS       PPNETCLC
                MOVE KNET-GROSS-OASDI       TO XFIC-PAR-OASDI-GRS       PPNETCLC
                CALL WS-PPFICA USING PPFICA-INTERFACE-DATA              PPNETCLC
                MOVE XFIC-YTD-OASDI-GRS     TO YTD-OASDI-GROSS          PPNETCLC
                MOVE XFIC-PAR-OASDI-GRS     TO KNET-GROSS-OASDI         PPNETCLC
                MOVE XFIC-OASDI-DED-TO-TAKE TO KNET-DED-TO-TAKE         PPNETCLC
                IF XFIC-YTD-OASDI-GRS-ADJ NOT = ZERO                    PPNETCLC
                   MOVE 1                      TO KNET-DOLLAR-ADJ-CNT   PPNETCLC
                   MOVE SPACES                 TO KNET-DOLLAR-ADJ (1)   PPNETCLC
                   MOVE XFIC-YTD-OASDI-GRS-ADJ TO KNET-ADJ-AMT (1)      PPNETCLC
                   MOVE OASDI-GRS-YTD-ELMT     TO KNET-ADJ-ELMT (1)     PPNETCLC
                END-IF                                                  PPNETCLC
             END-IF                                                     PPNETCLC
           END-IF.                                                      PPNETCLC
                                                                        PPNETCLC
       2200-FWT-CALC SECTION.                                           PPNETCLC
                                                                        PPNETCLC
           INITIALIZE FEDERAL-TAX-INTERFACE                             PPNETCLC
           MOVE KNET-FLAT-FWT-PERCENT TO KFED-FLAT-FWT-PERCENT          PPNETCLC
           MOVE KNET-FLAT-BFWT-PERCENT TO KFED-FLAT-BFWT-PERCENT.       48861503
           MOVE KNET-TAX-PERIOD       TO KFED-TAX-PERIOD.               PPNETCLC
           MOVE FEDTAX-MARITAL        TO KFED-FEDTAX-MARITAL.           PPNETCLC
           MOVE FEDTAX-EXEMPT         TO KFED-FEDTAX-EXEMPT.            PPNETCLC
           MOVE CITIZEN-CODE          TO KFED-CITIZEN-CODE.             PPNETCLC
           MOVE KNET-GROSS-FWT1       TO KFED-GROSS-FWT1                PPNETCLC
           MOVE KNET-GROSS-FWT2       TO KFED-GROSS-FWT2                PPNETCLC
           MOVE KNET-GROSS-FWT3       TO KFED-GROSS-FWT3.               48861503
           MOVE KNET-REDUCTIONS-FWT   TO KFED-REDUCTIONS-FWT.           PPNETCLC
           MOVE KNET-DOS-FEL-NRA-GRS  TO ADJ-DOS-FEL-NRA-GRS            69761691
           IF  (CITIZEN-CODE-NONRESID-ALN-EXMP  OR                      48901525
                CITIZEN-CODE-RESID-ALN-EXMP)                            48901525
                PERFORM 2210-TAX-FWT-OVER-TT-LIMIT                      48901525
           END-IF.                                                      48901525
           MOVE ZERO   TO KFED-POSTDOC-FEL-NRA-GRS,                     69331612
                          KFED-POSTDOC-FEL-NRA-RATE                     69331612
           IF   (KFED-CT-CODE-NON-RESID-ALIEN-T                         69761691
              OR KFED-CT-CODE-NONR-ALN-SPECCTRY)                        69761691
             AND KNET-DOS-FEL-NRA-GRS  > ZERO                           69331612
              IF KNET-DOS-FEL-NRA-GRS  NOT <  KNET-GROSS-TOTAL          69331612
                 SET KNET-BLOCK-NRA-FLAT-DED-ON  TO TRUE                69331612
              END-IF                                                    69331612
              MOVE  ADJ-DOS-FEL-NRA-GRS  TO KFED-POSTDOC-FEL-NRA-GRS    69761691
              IF  VISA-TYPE (1:1)  = 'F'                                69331612
               OR VISA-TYPE (1:1)  = 'J'                                69331612
                 MOVE KNET-POSTDOC-FWT-NRA-F-J                          69331612
                                          TO KFED-POSTDOC-FEL-NRA-RATE  69331612
              ELSE                                                      69331612
                 MOVE KNET-POSTDOC-FWT-NRA-OTH                          69331612
                                          TO KFED-POSTDOC-FEL-NRA-RATE  69331612
              END-IF                                                    69331612
           END-IF.                                                      69331612
                                                                        15611721
           MOVE KNET-CHECK-DATE           TO KFED-CHECK-DATE            15611721
           MOVE KNET-MO-PARM-AMT          TO KFED-MO-PARM-AMT           15611721
           MOVE KNET-SM-PARM-AMT          TO KFED-SM-PARM-AMT           15611721
           MOVE KNET-BI-PARM-AMT          TO KFED-BI-PARM-AMT           15611721
                                                                        15611721
           CALL WS-PPFEDTAX        USING FEDERAL-TAX-AREA               PPNETCLC
                                         FEDERAL-TAX-INTERFACE.         PPNETCLC
           IF KFED-MSSG-NO NOT = SPACES                                 69761691
               MOVE KFED-MSSG-NO TO KNET-MSSG-NO (1)                    69761691
           END-IF.                                                      69761691
           MOVE KFED-DED-TO-TAKE      TO KNET-DED-TO-TAKE.              PPNETCLC
           MOVE KFED-FEL-FWT-DED-TO-TAKE  TO KNET-FEL-FWT-DED-TO-TAKE.  69331612
                                                                        48901525
       2210-TAX-FWT-OVER-TT-LIMIT  SECTION.                             48901525
      *--->                                                             48901525
      *---> AT THIS POINT, THE YTD TAX TREATY (I.E., "TT") GROSS        48901525
      *---> INCLUDES THE PAR SWT GROSS (ADDED TO YTD IN PPP390) AND     48901525
      *---> ANY DOMESTIC PARNER INCOME (BUMPED BY PPP400 WHEN PREVIOUS  48901525
      *---> REDUCTIONS WERE HANDLED). HOWEVER, THE YTD TT GROSS HAS NOT 48901525
      *---> BEEN FACTORED BY REDUCTIONS. NOTE THAT THE SWT REDUCTION    48901525
      *---> TOTAL HAS BEEN FACTORED BY ANY DEPENDENT PARTNER TIP        48901525
      *---> REDUCTIONS.                                                 48901525
      *--->                                                             48901525
           IF KNET-STATE-GROSS > KNET-REDUCTIONS-SWT                    48901525
              COMPUTE  ZTT-REDUCTIONS     =  KNET-REDUCTIONS-SWT        48901525
              COMPUTE  ZTT-ADJ-STATE-GRS  =                             48901525
                       KNET-STATE-GROSS - KNET-REDUCTIONS-SWT           48901525
           ELSE                                                         48901525
              COMPUTE  ZTT-REDUCTIONS     =  KNET-STATE-GROSS           48901525
              COMPUTE  ZTT-ADJ-STATE-GRS  =  ZERO                       48901525
           END-IF.                                                      48901525
           SUBTRACT  ZTT-REDUCTIONS                                     48901525
               FROM  YTD-TT-GROSS  OF PPHDAUTL-INTERFACE                48901525
                     ETD-TT-GROSS  OF PPHDAUTL-INTERFACE.               48901525
           IF   KNET-DOS-FEL-NRA-GRS   > ZERO                           69761691
             AND TT-DOLLAR-LIMIT  > ZERO                                69761691
             AND FEDTAX-EXEMPT-EXMPT-FED-TX                             69761691
              PERFORM 2215-ADD-FEL-TO-YTD-TT-GROSS                      69761691
           END-IF                                                       69761691
           IF       TT-DOLLAR-LIMIT  > ZERO                             48901525
            AND YTD-TT-GROSS  OF PPHDAUTL-INTERFACE > TT-DOLLAR-LIMIT   48901525
               CONTINUE                                                 48901525
           ELSE                                                         48901525
               GO TO 2210-EXIT                                          48901525
           END-IF.                                                      48901525
           COMPUTE ZTT-AMT-OVER-LIMIT  =                                48901525
               YTD-TT-GROSS  OF PPHDAUTL-INTERFACE  -  TT-DOLLAR-LIMIT. 48901525
           IF      ZTT-AMT-OVER-LIMIT  >  ZTT-ADJ-STATE-GRS             48901525
               MOVE  ZTT-ADJ-STATE-GRS  TO ZTT-AMT-OVER-LIMIT           48901525
           END-IF.                                                      48901525
           IF        ZTT-AMT-OVER-LIMIT  NOT > ZERO                     48901525
               GO TO 2210-EXIT                                          48901525
           END-IF.                                                      48901525
           SUBTRACT  ZTT-AMT-OVER-LIMIT                                 48901525
               FROM  YTD-TT-GROSS  OF PPHDAUTL-INTERFACE                48901525
                     ETD-TT-GROSS  OF PPHDAUTL-INTERFACE.               48901525
      *---> CREATE FWT GROSS FOR THE AMT OF EARNINGS OVER TREATY LIMIT  48901525
           ADD  ZTT-AMT-OVER-LIMIT                                      48901525
                           TO  YTD-FWT-GROSS  OF PPHDAUTL-INTERFACE     48901525
                              FYTD-FWT-GROSS  OF PPHDAUTL-INTERFACE     48901525
                              KNET-YTD-FWT-GROSS                        48901525
                              KNET-FWT-GROSS                            48901525
                              KNET-GROSS-FWT1                           48901525
           MOVE ZEROS                 TO KNET-REDUCTIONS-FWT.           48901525
      *---> MODIFY THE FWT TAX LINKAGE TO SIMULATE THE CITIZENSHIP      48901525
      *---> AND TAX STATUS CHANGES WHICH WILL OCCUR IN THE NEXT MONTHLY 48901525
      *---> MAINTENANCE BECAUSE HE IS OVER THE TAX TREATY LIMIT         48901525
           IF  CTRY-ORIGIN-NONR-ALN-SPECCTRY                            48901525
               MOVE 'A'               TO KFED-CITIZEN-CODE              48901525
           ELSE                                                         48901525
               MOVE 'N'               TO KFED-CITIZEN-CODE              48901525
           END-IF.                                                      48901525
           MOVE 'S'                   TO KFED-FEDTAX-MARITAL.           48901525
           MOVE 001                   TO KFED-FEDTAX-EXEMPT.            48901525
           MOVE KNET-GROSS-FWT1       TO KFED-GROSS-FWT1                48901525
           MOVE KNET-REDUCTIONS-FWT   TO KFED-REDUCTIONS-FWT.           48901525
       2210-EXIT.    EXIT.                                              48901525
                                                                        69761691
       2215-ADD-FEL-TO-YTD-TT-GROSS    SECTION.                         69761691
      *---> SEE IF YTD TAX TREATY GRS IS AT THE LIMIT WITHOUT INCLUDING 69761691
      *---> THE CURRENT "FEL" PAYMENT                                   69761691
           IF  YTD-TT-GROSS  OF PPHDAUTL-INTERFACE  = TT-DOLLAR-LIMIT   69761691
              IF  CTRY-ORIGIN-NONR-ALN-SPECCTRY                         69761691
                 MOVE 'A'               TO KFED-CITIZEN-CODE            69761691
              ELSE                                                      69761691
                 MOVE 'N'               TO KFED-CITIZEN-CODE            69761691
              END-IF                                                    69761691
              MOVE 'S'                   TO KFED-FEDTAX-MARITAL         69761691
              MOVE 001                   TO KFED-FEDTAX-EXEMPT          69761691
              GO TO 2215-EXIT                                           69761691
           END-IF.                                                      69761691
           IF  YTD-TT-GROSS  OF PPHDAUTL-INTERFACE  < TT-DOLLAR-LIMIT   69761691
      *----> SINCE YTD TAX TREATY GRS IS UNDER THE LIMIT, WE MUST ADD   69761691
      *----> THE "FEL" GROSS TO THE YTD TAX TREATY GROSS                69761691
              COMPUTE TEMP-AMT-UNDER-LIMIT =                            69761691
                 TT-DOLLAR-LIMIT  - YTD-TT-GROSS  OF PPHDAUTL-INTERFACE 69761691
              IF   KNET-DOS-FEL-NRA-GRS  <  TEMP-AMT-UNDER-LIMIT        69761691
                 MOVE KNET-DOS-FEL-NRA-GRS   TO ADJ-DOS-FEL-NRA-GRS     69761691
              ELSE                                                      69761691
                 MOVE TEMP-AMT-UNDER-LIMIT   TO ADJ-DOS-FEL-NRA-GRS     69761691
                 IF  CTRY-ORIGIN-NONR-ALN-SPECCTRY                      69761691
                    MOVE 'A'               TO KFED-CITIZEN-CODE         69761691
                 ELSE                                                   69761691
                    MOVE 'N'               TO KFED-CITIZEN-CODE         69761691
                 END-IF                                                 69761691
                 MOVE 'S'                   TO KFED-FEDTAX-MARITAL      69761691
                 MOVE 001                   TO KFED-FEDTAX-EXEMPT       69761691
              END-IF                                                    69761691
              ADD       ADJ-DOS-FEL-NRA-GRS                             69761691
                 TO  YTD-TT-GROSS  OF PPHDAUTL-INTERFACE                69761691
                     ETD-TT-GROSS  OF PPHDAUTL-INTERFACE                69761691
              SUBTRACT  ADJ-DOS-FEL-NRA-GRS                             69761691
                 FROM  YTD-FELLOWSHIP-GRS  OF PPHDAUTL-INTERFACE        69761691
                       KNET-GROSS-FELLOWSHIP                            69761691
              COMPUTE   ADJ-DOS-FEL-NRA-GRS =                           69761691
                       KNET-DOS-FEL-NRA-GRS                             69761691
                     -  ADJ-DOS-FEL-NRA-GRS                             69761691
           END-IF.                                                      69761691
       2215-EXIT.   EXIT.                                               69761691
                                                                        PPNETCLC
       2300-FEL-NRA-FWT-CALC  SECTION.                                  69331612
      *---> ALTHOUGH THE GTN USAGE IS "P" (PERCENT) THE ACTUAL PERCENT  69331612
      *---> CALCULATION WAS PERFORMED IN PPFEDTAX AND THE RESULTING DED 69331612
      *---> AMOUNT WAS USED TO TEMPORARILY SET UP A "G" BALANCE FOR THIS69331612
      *---> GTN NUMBER.                                                 69331612
           SET KNET-NO-HALVING TO TRUE                                  69331612
           MOVE KNET-DED-BALAMT-GTN  TO KNET-DED-TO-TAKE.               69331612
           IF KNET-DED-TO-TAKE   < ZERO                                 69331612
              MOVE ZERO  TO KNET-DED-TO-TAKE                            69331612
           END-IF.                                                      69331612
       2300-EXIT.    EXIT.                                              69331612
                                                                        69331612
       2400-EIC-CALC SECTION.                                           PPNETCLC
                                                                        PPNETCLC
           MOVE ZERO TO WS-KNET-BASE-TOTAL.                             48631400
           IF   (KNET-GROSS-FWT1 = ZERO                                 PPNETCLC
             AND KNET-GROSS-FWT2 = ZERO                                 PPNETCLC
             AND KNET-REDUCTIONS-FWT NOT > ZERO)                        PPNETCLC
            OR   KNET-GTN-CYCLES (1) = 'XX'                             PPNETCLC
                 MOVE ZERO TO KNET-DED-TO-TAKE                          PPNETCLC
                 GO TO 2499-EIC-EXIT                                    PPNETCLC
           END-IF.                                                      PPNETCLC
           PERFORM VARYING S4 FROM +1 BY +1                             PPNETCLC
             UNTIL S4 > +4                                              PPNETCLC
                OR XFEA-PERIOD (S4) = KNET-TAX-PERIOD                   PPNETCLC
           END-PERFORM.                                                 PPNETCLC
           IF S4 > +4                                                   PPNETCLC
              MOVE +1 TO S4                                             PPNETCLC
              MOVE M40027 TO KNET-MSSG-NO (1)                           PPNETCLC
           END-IF.                                                      PPNETCLC
      *---> WHEN "FEDTAX-EXEMPT" IS 999, THE FWT GROSS WILL BE ZERO     48721431
      *---> AND THE EMPLOYEE IS NOT ELIGIBLE FOR THE EIC REBATE.        48721431
      *---> WHEN "FEDTAX-EXEMPT" IS 998, FWT GROSS HAS BEEN DEVELOPED   48721431
      *---> AND THE EMPLOYEE IS ELIGIBLE FOR THE EIC REBATE.            48721431
           IF FEDTAX-EXEMPT = 999                                       48631400
              MOVE ZERO TO KNET-DED-TO-TAKE                             48721431
              GO TO 2499-EIC-EXIT                                       48721431
           ELSE                                                         PPNETCLC
             IF  KNET-GROSS-FWT1 > ZEROS                                PPNETCLC
              OR KNET-REDUCTIONS-FWT < ZEROES                           PPNETCLC
                 COMPUTE KNET-BASE                                      PPNETCLC
                       = KNET-GROSS-FWT1 - KNET-REDUCTIONS-FWT          PPNETCLC
                 IF KNET-BASE < ZEROS                                   PPNETCLC
                    COMPUTE KNET-AMOUNT = - KNET-BASE                   PPNETCLC
                    MOVE ZEROS TO KNET-BASE                             PPNETCLC
                 ELSE                                                   PPNETCLC
                    MOVE ZEROS TO KNET-AMOUNT                           PPNETCLC
                 END-IF                                                 PPNETCLC
             ELSE                                                       PPNETCLC
               MOVE KNET-REDUCTIONS-FWT TO KNET-AMOUNT                  PPNETCLC
               MOVE ZEROS TO KNET-BASE                                  PPNETCLC
             END-IF                                                     PPNETCLC
           END-IF.                                                      PPNETCLC
           IF KNET-EIC-BALAMT-GTN = +2.00                               PPNETCLC
              MOVE 07 TO S5                                             48631400
              COMPUTE S6 = XFEA-NO-MARRIED (S4) + 07                    48631400
           ELSE                                                         PPNETCLC
             IF KNET-EIC-BALAMT-GTN = +1.00                             PPNETCLC
                MOVE 1 TO S5                                            PPNETCLC
                COMPUTE S6 = XFEA-NO-SINGLES (S4) + 1                   PPNETCLC
             ELSE                                                       48631400
               IF KNET-EIC-BALAMT-GTN = +3.00                           48631400
                  MOVE 13 TO S5                                         48631400
                  COMPUTE S6 = XFEA-NO-MAR-SP-NOTFILW5 (S4) + 13        48631400
               ELSE                                                     48631400
                  GO TO 2499-EIC-EXIT                                   48631400
               END-IF                                                   48631400
             END-IF                                                     48631400
           END-IF.                                                      48631400
           IF KNET-BASE = ZEROS                                         PPNETCLC
              MOVE ZEROS TO KNET-DED-TO-TAKE                            PPNETCLC
           ELSE                                                         PPNETCLC
              PERFORM VARYING S5 FROM S5 BY +1                          PPNETCLC
                UNTIL S5 = S6                                           PPNETCLC
                   OR XFEA-SALARY (S4, S5) > KNET-BASE                  PPNETCLC
              END-PERFORM                                               PPNETCLC
              ADD -1 TO S5                                              PPNETCLC
              COMPUTE KNET-DED-TO-TAKE = XFEA-TAX (S4 S5)               PPNETCLC
              + ((KNET-BASE - XFEA-SALARY (S4 S5)) * XFEA-PCT (S4 S5))  PPNETCLC
           END-IF.                                                      PPNETCLC
           IF KNET-DED-TO-TAKE < ZEROS                                  PPNETCLC
              MOVE ZEROS TO KNET-DED-TO-TAKE                            PPNETCLC
           ELSE                                                         PPNETCLC
              COMPUTE KNET-DED-TO-TAKE = KNET-DED-TO-TAKE * -1          PPNETCLC
           END-IF.                                                      PPNETCLC
           IF KNET-GROSS-FWT2 > ZEROS                                   PPNETCLC
              COMPUTE KNET-BASE = KNET-GROSS-FWT2 - KNET-AMOUNT         PPNETCLC
              IF KNET-BASE < ZEROS                                      PPNETCLC
                 MOVE ZEROS TO KNET-BASE                                PPNETCLC
              END-IF                                                    PPNETCLC
           ELSE                                                         PPNETCLC
              MOVE ZEROS TO KNET-BASE                                   PPNETCLC
           END-IF.                                                      PPNETCLC
           MOVE ZEROS TO KNET-AMOUNT.                                   PPNETCLC
           IF KNET-BASE = ZEROS                                         PPNETCLC
              IF KNET-DED-TO-TAKE  <  ZERO                              48631400
                 PERFORM 2410-EIC-CAP-CHECK                             48631400
              END-IF                                                    48631400
              GO TO 2499-EIC-EXIT                                       PPNETCLC
           END-IF.                                                      PPNETCLC
           IF KNET-EIC-BALAMT-GTN = +2.00                               48631400
              MOVE 07 TO S5                                             48631400
           ELSE                                                         48631400
              IF KNET-EIC-BALAMT-GTN = +3.00                            48631400
                 MOVE 13 TO S5                                          48631400
              ELSE                                                      48631400
                 MOVE 1 TO S5                                           48631400
              END-IF                                                    48631400
           END-IF.                                                      48631400
           PERFORM VARYING S5 FROM S5 BY +1                             PPNETCLC
             UNTIL S5 = S6                                              PPNETCLC
                OR XFEA-SALARY (S4, S5) > KNET-BASE                     PPNETCLC
           END-PERFORM.                                                 PPNETCLC
           ADD -1 TO S5.                                                PPNETCLC
           COMPUTE KNET-AMOUNT = XFEA-TAX (S4, S5)                      PPNETCLC
           + ((KNET-BASE - XFEA-SALARY (S4 S5)) * XFEA-PCT (S4 S5)).    PPNETCLC
           IF KNET-AMOUNT < ZEROS                                       PPNETCLC
              MOVE ZEROS TO KNET-AMOUNT                                 PPNETCLC
           ELSE                                                         PPNETCLC
              COMPUTE KNET-AMOUNT = KNET-AMOUNT * -1                    PPNETCLC
           END-IF.                                                      PPNETCLC
           COMPUTE KNET-DED-TO-TAKE = KNET-DED-TO-TAKE + KNET-AMOUNT.   PPNETCLC
           IF KNET-DED-TO-TAKE < ZERO                                   48631400
              PERFORM 2410-EIC-CAP-CHECK                                48631400
           END-IF.                                                      48631400
                                                                        PPNETCLC
       2499-EIC-EXIT.                                                   PPNETCLC
           EXIT.                                                        PPNETCLC
                                                                        48631400
       2410-EIC-CAP-CHECK  SECTION.                                     48631400
                                                                        48631400
      *----->  reverse the negative signs for calculated EIC Payment    48631400
      *----->  and YTD EIC payment.                                     48631400
           COMPUTE WS-CURRENT-EIC-PAYMENT = KNET-DED-TO-TAKE * -1.      48631400
           COMPUTE WS-OLD-YTD-EIC-PAYMENT                               48631400
                                  = KNET-EIC-YTD-PAYMENT   * -1.        48631400
                                                                        48631400
           COMPUTE WS-TOTAL-YTD-EIC-PAYMENT                             48631400
                   = WS-CURRENT-EIC-PAYMENT  + WS-OLD-YTD-EIC-PAYMENT.  48631400
                                                                        48631400
      *----->  Determine whether Total YTD EIC Payment is over the CAP. 48631400
           IF WS-TOTAL-YTD-EIC-PAYMENT  > KNET-EIC-PAYMENT-CAP          48631400
      *----->  Compare the YTD EIC Payment without the current EIC paymt48631400
      *----->  to the CAP, and calculate the difference.                48631400
              IF WS-OLD-YTD-EIC-PAYMENT < KNET-EIC-PAYMENT-CAP          48631400
                 COMPUTE WS-DIFF-EIC-PAYMENT                            48631400
                      = KNET-EIC-PAYMENT-CAP - WS-OLD-YTD-EIC-PAYMENT   48631400
                 COMPUTE KNET-DED-TO-TAKE  = WS-DIFF-EIC-PAYMENT * -1   48631400
              ELSE                                                      48631400
                 MOVE ZERO TO KNET-DED-TO-TAKE                          48631400
              END-IF                                                    48631400
           END-IF.                                                      48631400
                                                                        48631400
           IF KNET-DED-TO-TAKE NOT = ZERO                               48631400
              PERFORM 2420-EIC-EARNINGS-CHECK                           48631400
           END-IF.                                                      48631400
                                                                        48631400
       2420-EIC-EARNINGS-CHECK   SECTION.                               48631400
                                                                        48631400
           MOVE KNET-YTD-FWT-GROSS TO WS-YTD-FWT-GROSS.                 48631400
                                                                        48631400
      *--->  Before using KNET-YTD-FWT-GROSS, adjust KNET FWT Gross     48631400
      *--->  by subtracting the FWT Reductions.                         48631400
           COMPUTE  WS-YTD-FWT-GROSS                                    48721431
                          = KNET-YTD-FWT-GROSS - KNET-REDUCTIONS-FWT    48631400
      *--->  Add the YTD  FWT Gross  and YTD EIC Exempt Gross (i.e.,    48721431
      *--->  these are prior earnings from a point during the year when 48721431
      *--->  the employee was ineligible for EIC)                       48721431
           COMPUTE WS-KNET-BASE-TOTAL = KNET-YTD-EIC-EXEMPT-GROSS       48631400
                                      + WS-YTD-FWT-GROSS.               48631400
                                                                        48631400
           EVALUATE TRUE                                                48631400
               WHEN KNET-EIC-BALAMT-GTN = +1                            48631400
                  IF WS-KNET-BASE-TOTAL >= KNET-EIC-EARNINGS-LIM-1      48631400
                     MOVE ZERO TO KNET-DED-TO-TAKE                      48631400
                  END-IF                                                48631400
               WHEN KNET-EIC-BALAMT-GTN = +2                            48631400
               WHEN KNET-EIC-BALAMT-GTN = +3                            48631400
                  IF WS-KNET-BASE-TOTAL >= KNET-EIC-EARNINGS-LIM-2-3    48631400
                     MOVE ZERO TO KNET-DED-TO-TAKE                      48631400
                  END-IF                                                48631400
           END-EVALUATE.                                                48631400
                                                                        PPNETCLC
       2500-SWT-CALC SECTION.                                           PPNETCLC
                                                                        PPNETCLC
           INITIALIZE STATE-TAX-INTERFACE.                              PPNETCLC
           MOVE KNET-FLAT-SWT-PERCENT TO KSTE-FLAT-SWT-PERCENT          PPNETCLC
           MOVE KNET-FLAT-BSWT-PERCENT TO KSTE-FLAT-BSWT-PERCENT.       48861503
           MOVE KNET-TAX-PERIOD       TO KSTE-TAX-PERIOD.               PPNETCLC
           MOVE STATE-TAX-MARITAL     TO KSTE-STATE-TAX-MARITAL.        PPNETCLC
           MOVE STATE-TAX-PERDED      TO KSTE-STATE-TAX-PERDED.         PPNETCLC
           MOVE STATE-TAX-ITMDED      TO KSTE-STATE-TAX-ITMDED.         PPNETCLC
           MOVE KNET-GROSS-SWT1       TO KSTE-GROSS-SWT1                PPNETCLC
           MOVE KNET-GROSS-SWT2       TO KSTE-GROSS-SWT2                PPNETCLC
           MOVE KNET-GROSS-SWT3       TO KSTE-GROSS-SWT3.               48861503
           MOVE KNET-REDUCTIONS-SWT   TO KSTE-REDUCTIONS-SWT            PPNETCLC
           CALL WS-PPSTETAX USING STX-INFORMATION                       PPNETCLC
                                  STATE-TAX-INTERFACE.                  PPNETCLC
           MOVE KSTE-DED-TO-TAKE      TO KNET-DED-TO-TAKE.              PPNETCLC
                                                                        PPNETCLC
       3000-LEGAL-CALC SECTION.                                         PPNETCLC
                                                                        PPNETCLC
           IF XGTN-BENEFIT-PLAN = LEGAL-PLAN                            PPNETCLC
              MOVE LEGAL-COVEFFDATE TO KXJD-COVERAGE-EFFECT-DATE        28521025
              MOVE LEGAL-PLAN TO KXJD-PLAN-CODE                         PPNETCLC
              MOVE LEGAL-COVERAGE TO KXJD-COVERAGE-CODE                 PPNETCLC
              MOVE KNET-DED-BRSC-ARRAY TO KXJD-BRSC                     PPNETCLC
              MOVE KNET-END-YYMMDD TO XDC3-STD-DATE                     01341440
              IF XDC3-STD-MM = 12                                       01341440
                 MOVE 01 TO XDC3-STD-MM                                 01341440
                 ADD 01 TO XDC3-STD-YY                                  01341440
              END-IF                                                    01341440
              MOVE XDC3-STD-DATE TO KXJD-PAY-CYCLE-END-DATE             01341440
              CALL WS-PPBENXJD                                          PPNETCLC
              IF KXJD-RETURN-STATUS-ABORTING                            PPNETCLC
                  MOVE M40993 TO KNET-MSSG-NO (1)                       PPNETCLC
                  GOBACK                                                PPNETCLC
              ELSE                                                      PPNETCLC
                 MOVE KXJD-EMPLOYEE-DEDUCTION TO KNET-DED-TO-TAKE       PPNETCLC
                 MOVE KXJD-EMPLOYER-CONTRIBUTION TO KNET-MC-DED-TO-TAKE PPNETCLC
                 PERFORM 9000-BEN-STATUS-CHK                            PPNETCLC
                 IF KXJD-RETURN-STATUS-FLAG = '2'                       PPNETCLC
                    MOVE M40111 TO KNET-MSSG-NO (1)                     PPNETCLC
                 END-IF                                                 PPNETCLC
              END-IF                                                    PPNETCLC
           END-IF.                                                      PPNETCLC
                                                                        PPNETCLC
       3200-TIER2016-RETIREMENT-CALC  SECTION.                          12082230
      ***************************************************************   12082230
      *   IF PPBENR16 HAS ALREADY BEEN CALLED, RETURN THE               12082230
      *   APPROPRIATE VALUE.                                            12082230
      *   OTHERWISE, POPULATE CPLNKR16 AND CALL PPBENR16                12082230
      ***************************************************************   12082230
                                                                        12082230
           MOVE KNET-DEDX TO RETIREMENT-ELEMENTS.                       12082230
           MOVE ZEROES TO KNET-DED-TO-TAKE                              12082230
                          KNET-MC-DED-TO-TAKE.                          12082230
                                                                        12082230
           IF TIER2016-GTN                                              12082230
              CONTINUE                                                  12082230
           ELSE                                                         12082230
              GO TO 3200-EXIT                                           12082230
           END-IF.                                                      12082230
                                                                        12082230
           IF  KNET-TIER2016-DB-DED      = ZERO                         12082230
           AND KNET-TIER2016-DB-CON      = ZERO                         12082230
           AND KNET-TIER2016-SUPP-DED    = ZERO                         12082230
           AND KNET-TIER2016-SUPP-CON    = ZERO                         12082230
           AND KNET-TIER2016-SUPP-DED-F  = ZERO                         12082230
           AND KNET-TIER2016-SUPP-CON-F  = ZERO                         12082230
           AND KNET-TIER2016-DC-DED      = ZERO                         12082230
           AND KNET-TIER2016-DC-CON      = ZERO                         12082230
           AND KNET-TIER2016-UPL         = ZERO                         12082230
               PERFORM 3210-CALL-PPBENR16                               12082230
           END-IF.                                                      12082230
                                                                        12082230
           EVALUATE TRUE                                                12082230
             WHEN TIER2016-DB-DED                                       12082230
               MOVE KNET-TIER2016-DB-DED        TO KNET-DED-TO-TAKE     12082230
               MOVE KNET-TIER2016-DB-CON        TO KNET-MC-DED-TO-TAKE  12082230
             WHEN TIER2016-SUP-DED                                      12082230
               MOVE KNET-TIER2016-SUPP-DED      TO KNET-DED-TO-TAKE     12082230
               MOVE KNET-TIER2016-SUPP-CON      TO KNET-MC-DED-TO-TAKE  12082230
             WHEN TIER2016-SUP-DED-F                                    12082230
               MOVE KNET-TIER2016-SUPP-DED-F    TO KNET-DED-TO-TAKE     12082230
               MOVE KNET-TIER2016-SUPP-CON-F    TO KNET-MC-DED-TO-TAKE  12082230
             WHEN TIER2016-DC-DED                                       12082230
               MOVE KNET-TIER2016-DC-DED        TO KNET-DED-TO-TAKE     12082230
               MOVE KNET-TIER2016-DC-CON        TO KNET-MC-DED-TO-TAKE  12082230
             WHEN TIER2016-UPL                                          12082230
               MOVE KNET-TIER2016-UPL           TO KNET-DED-TO-TAKE     12082230
           END-EVALUATE.                                                12082230
                                                                        12082230
       3200-EXIT.                                                       12082230
           EXIT.                                                        12082230
                                                                        12082230
       3210-CALL-PPBENR16  SECTION.                                     12082230
      ***************************************************************   12082230
      *                                                                 12082230
      ***************************************************************   12082230
                                                                        12082230
           MOVE KNET-EMPLOYEE-ID        TO KR16-EMPLOYEE-ID             12082230
           MOVE KNET-PAR-FICA-ELIG-CD   TO KR16-FICA-ELIG-CODE          12082230
           MOVE KNET-GROSS-RETR         TO KR16-RETIREMENT-GROSS        12082230
           MOVE RET-ELIG-CODE           TO KR16-RETIRE-SYS-CODE         12082230
           MOVE KNET-FYTD-ADJ-RET-GROSS TO KR16-RETIREMENT-GROSS-FYTD   12082230
           MOVE KNET-END-YYMMDD         TO KR16-PERIOD-END-DATE         12082230
           MOVE COV-COMP-LIMIT-CD       TO KR16-EMP-COVCOMP-LIMIT-CD    12082230
           MOVE KNET-EMP-UNIT-CODE         TO KR16-EMP-UNIT-CODE.       12082230
           MOVE KNET-EMP-REP-CODE          TO KR16-EMP-REP-CODE.        12082230
           MOVE KNET-EMP-BEN-ELIG-UNIT-CD  TO KR16-BEN-ELIG-UNIT-CD.    12082230
           MOVE KNET-EMP-BEN-ELIG-REP-CD   TO KR16-BEN-ELIG-REP-CD.     12082230
           MOVE KNET-COVCOMP-GRANDF-LIMIT TO  KR16-COVCOMP-GRANDF-LIMIT 12082230
           MOVE KNET-COVCOMP-NT-GRANDF-LIMIT                            12082230
                                   TO  KR16-COVCOMP-NT-GRANDF-LIMIT     12082230
           MOVE KNET-COVCOMP-LIM-2016-COORD                             12082230
                                   TO  KR16-COVCOMP-LIM-2016-COORD      12082230
           MOVE KNET-COVCOMP-LIM-2016-NONCOOR                           12082230
                                   TO  KR16-COVCOMP-LIM-2016-NONCOOR    12082230
                                                                        12082230
           MOVE BEN-FACULTY-IND    TO  KR16-EMP-FACULTY-CODE            12082230
                                                                        12082230
           CALL WS-PPBENR16                                             12082230
                                                                        12082230
           IF KR16-RETURN-STATUS-ABORTING                               12082230
              MOVE M40991 TO KNET-MSSG-NO (1)                           12082230
              GOBACK                                                    12082230
           END-IF.                                                      12082230
                                                                        12082230
           MOVE KR16-DB-EE-DED         TO KNET-TIER2016-DB-DED          12082230
           MOVE KR16-DB-ER-CON         TO KNET-TIER2016-DB-CON          12082230
           MOVE KR16-SUPP-EE-DED       TO KNET-TIER2016-SUPP-DED        12082230
           MOVE KR16-SUPP-ER-CON       TO KNET-TIER2016-SUPP-CON        12082230
           MOVE KR16-SUPP-EE-DED-FAC   TO KNET-TIER2016-SUPP-DED-F      12082230
           MOVE KR16-SUPP-ER-CON-FAC   TO KNET-TIER2016-SUPP-CON-F      12082230
           MOVE KR16-DC-EE-DED         TO KNET-TIER2016-DC-DED          12082230
           MOVE KR16-DC-ER-CON         TO KNET-TIER2016-DC-CON          12082230
           MOVE KR16-UPL               TO KNET-TIER2016-UPL.            12082230
                                                                        12082230
       3210-EXIT.                                                       12082230
           EXIT.                                                        12082230
                                                                        12082230
       3500-DCP-CALC SECTION.                                           PPNETCLC
                                                                        PPNETCLC
           IF (KNET-DEDX = 733 AND DCP-PLAN-CODE-YES)                   11671644
              COMPUTE KNET-DED-TO-TAKE ROUNDED = KNET-DCP-DED-TO-TAKE   PPNETCLC
              MOVE ZERO TO KNET-MC-DED-TO-TAKE                          PPNETCLC
              MOVE ZERO TO KNET-DCP-DED-TO-TAKE                         PPNETCLC
           END-IF.                                                      PPNETCLC
                                                                        PPNETCLC
       4000-DCP-CASUAL-CALC SECTION.                                    PPNETCLC
                                                                        PPNETCLC
           MOVE ZERO TO KNET-DED-TO-TAKE                                PPNETCLC
                        KNET-MC-DED-TO-TAKE.                            PPNETCLC
           IF NOT RET-ELIG-CODE-SFHBR-RETR                              PPNETCLC
              GO TO 4099-DCP-CAS-EXIT                                   PPNETCLC
           END-IF.                                                      PPNETCLC
           IF  (KNET-DEDX = 734 AND DCP-PLAN-CODE-YES)                  11671644
              MOVE KNET-REDUCTIONS-FICA   TO KSH-REDUCTIONS-SH          PPNETCLC
              IF   (KNET-INS-REDUCT-IND = ' ' OR 'Y' OR 'H')            32181188
                SUBTRACT KNET-DP-TIP-FED-AMT FROM KSH-REDUCTIONS-SH     30001947
              END-IF                                                    32181188
              IF    ((KNET-TTL3253-PRESENT  > ZERO                      69331612
                   OR KNET-TTL3254-PRESENT  > ZERO)                     69331612
               AND KNET-DOS-PDD-PRESENT  = ZERO)                        69331612
                CONTINUE                                                69331612
              ELSE                                                      69331612
                ADD KNET-DP-DPI-FED-AMT TO  KNET-GROSS-RETR             30001947
              END-IF                                                    69331612
              MOVE KNET-OASDI-MAX-TAXABLE TO KSH-MAX-SH-GROSS           PPNETCLC
              MOVE YTD-SFHBR-GROSS        TO KSH-YTD-SH-GROSS           PPNETCLC
              MOVE KNET-GROSS-RETR        TO KSH-PAR-SH-GROSS           PPNETCLC
              PERFORM 0405-CALC-LIMITS                                  52191347
              CALL WS-PPBENSH                                           PPNETCLC
              IF KSH-RETURN-STATUS-ABORTING                             PPNETCLC
                 MOVE M00931 TO KNET-MSSG-NO (1)                        PPNETCLC
                 GOBACK                                                 PPNETCLC
              END-IF                                                    PPNETCLC
                                                                        52191347
      *------> Update the YTD Safe Harbor DCP Gross only by the amount  52191347
      *------> used in the calculation of the deduction.                52191347
              IF  KSH-SH-DED-TO-TAKE > ZERO                             52191347
                  ADD KSH-PAR-SH-GROSS TO YTD-SFHBR-GROSS               52191347
              END-IF                                                    52191347
                                                                        52191347
              MOVE KSH-PAR-SH-GROSS TO KNET-GROSS-RETR                  PPNETCLC
                                                                        52191347
      *------> Update the FYTD Safe Harbor DCP Gross by the amount used 52191347
      *------> in the calculation of the Safe Harbor Deduction          52191347
              IF KSH-SFHR-DCP-GROSS-LIMIT NOT > KSH-PAR-SH-GROSS        52191347
                 ADD KSH-SFHR-DCP-GROSS-LIMIT TO FTD-SFHR-DCP-GROSS     52191347
              ELSE                                                      52191347
                 ADD KSH-PAR-SH-GROSS TO FTD-SFHR-DCP-GROSS             52191347
              END-IF                                                    52191347
                                                                        52191347
              MOVE KSH-SH-DED-TO-TAKE TO KNET-DED-TO-TAKE               PPNETCLC
              IF KSH-YTD-SH-GROSS-ADJ NOT = ZERO                        PPNETCLC
                 MOVE +1 TO KNET-DOLLAR-ADJ-CNT                         PPNETCLC
                 MOVE SPACES TO KNET-DOLLAR-ADJ (1)                     PPNETCLC
                 MOVE YTD-SFHBR-GROSS-ELMT TO KNET-ADJ-ELMT (1)         PPNETCLC
                 MOVE KSH-YTD-SH-GROSS-ADJ TO KNET-ADJ-AMT (1)          PPNETCLC
              END-IF                                                    PPNETCLC
           END-IF.                                                      PPNETCLC
                                                                        PPNETCLC
       4099-DCP-CAS-EXIT.                                               PPNETCLC
           EXIT.                                                        PPNETCLC
                                                                        52191347
       4500-SSDCP-CALC      SECTION.                                    52191347
                                                                        52191347
           MOVE ZERO TO KNET-DED-TO-TAKE                                52191347
                        KNET-MC-DED-TO-TAKE.                            52191347
                                                                        52191347
      *----> Employee eligibility based on Retirement Plan Code         52191347
           IF RET-ELIG-CODE = (SPACE OR 'N' OR 'H')                     52191347
              GO TO 4500-SSDCP-CALC-EXIT                                52191347
           ELSE                                                         52191347
      *------> Employer DCP Summer Salary Contribution GTN              52191347
              IF (KNET-DEDX = 736 AND  DCP-PLAN-CODE-YES)               11671644
                    PERFORM 4510-CALC-SS-LIMITS                         12082230
      *********** PERFORM 0405-CALC-LIMITS                              12082230
                                                                        52191347
                 CALL WS-PPFSSDCP                                       52191347
                 IF KFS-RETURN-STATUS-ABORTING                          52191347
                    MOVE M40980 TO KNET-MSSG-NO (1)                     52191347
                    GOBACK                                              52191347
                 END-IF                                                 52191347
                 MOVE ZERO TO KNET-MC-DED-TO-TAKE                       52191347
                 MOVE KFS-SSDCP-MC-DED-TO-TAKE TO KNET-DED-TO-TAKE      52191347
                                                                        52191347
      *----------> Update the FYTD FCSS DCP Gross by the amount used    52191347
      *----------> in the calculation of the FCSS DCP Deduction         52191347
                 ADD  KFS-FCSS-DCP-GROSS-LIMIT  TO FTD-FCSS-DCP-GROSS   52191347
              ELSE                                                      52191347
      *------> Employee DCP Summer Salary Deduction GTN                 52191347
                 IF (KNET-DEDX = 735 AND  DCP-PLAN-CODE-YES)            11671644
                    PERFORM 4510-CALC-SS-LIMITS                         12082230
      ************* PERFORM 0405-CALC-LIMITS                            12082230
                    CALL WS-PPFSSDCP                                    52191347
                    IF KFS-RETURN-STATUS-ABORTING                       52191347
                       MOVE M40980 TO KNET-MSSG-NO (1)                  52191347
                       GOBACK                                           52191347
                    END-IF                                              52191347
                                                                        52191347
                    MOVE ZERO                  TO KNET-MC-DED-TO-TAKE   52191347
                    MOVE KFS-SSDCP-DED-TO-TAKE TO KNET-DED-TO-TAKE      52191347
                 END-IF                                                 52191347
              END-IF                                                    52191347
           END-IF.                                                      52191347
                                                                        52191347
       4500-SSDCP-CALC-EXIT.                                            52191347
           EXIT.                                                        52191347
                                                                        78391373
       4510-CALC-SS-LIMITS      SECTION.                                12082230
      ****************************************************************  12082230
      * CODE MOVED FROM 0405-CALC-LIMITS                                12082230
      ****************************************************************  12082230
                                                                        12082230
           MOVE KNET-TOTAL-SSDCP-ELIG-EARN                              12082230
                                 TO WS-CURRENT-SUMMER-SALARY-EARNS.     12082230
                                                                        12082230
           MOVE ZERO TO WS-SUMMER-SAL-COMP-LIMIT.                       12082230
                                                                        12082230
           IF COV-COMP-LIMIT-CD =  'G'                                  12082230
              COMPUTE WS-SUMMER-SAL-COMP-LIMIT ROUNDED                  12082230
      *--------> From System Parameter 023                              12082230
                       = (KNET-COVCOMP-GRANDF-LIMIT * .25)              12082230
           ELSE                                                         12082230
              IF COV-COMP-LIMIT-CD = ('N' OR 'P' OR 'Q' OR 'SPACE')     12082230
                 COMPUTE WS-SUMMER-SAL-COMP-LIMIT ROUNDED               12082230
      *--------> From System Parameter 067                              12082230
                       = (KNET-COVCOMP-NT-GRANDF-LIMIT * .25)           12082230
              END-IF                                                    12082230
           END-IF.                                                      12082230
                                                                        12082230
           COMPUTE WS-SUMMER-SALARY-LIMIT                               12082230
                    =  (WS-SUMMER-SAL-COMP-LIMIT                        12082230
                           -  KNET-PRIOR-FYTD-FCSS-DCP-GROSS).          12082230
                                                                        12082230
           IF WS-SUMMER-SALARY-LIMIT < ZERO                             12082230
              MOVE ZERO TO WS-SUMMER-SALARY-LIMIT                       12082230
           END-IF.                                                      12082230
                                                                        12082230
      *----> Select lesser of the calculated limits from above          12082230
      *----> and use it for the calculation of the FSS Deduction.       12082230
           IF WS-CURRENT-SUMMER-SALARY-EARNS                            12082230
                  > WS-SUMMER-SALARY-LIMIT                              12082230
              MOVE WS-SUMMER-SALARY-LIMIT TO WS-FCSS-DCP-GROSS-LIMIT    12082230
           ELSE                                                         12082230
              MOVE WS-CURRENT-SUMMER-SALARY-EARNS                       12082230
                                          TO WS-FCSS-DCP-GROSS-LIMIT    12082230
           END-IF.                                                      12082230
                                                                        12082230
           MOVE WS-FCSS-DCP-GROSS-LIMIT                                 12082230
                               TO  KFS-FCSS-DCP-GROSS-LIMIT.            12082230
                                                                        12082230
       4510-EXIT.                                                       12082230
           EXIT.                                                        12082230
                                                                        PPNETCLC
       5000-BX-INITIATION-FEE  SECTION.                                 78391373
           IF  KNET-DED-BALAMT-GTN > ZERO                               78391373
            AND KNET-BX-INITIATION-FEE-SW-ON                            78391373
               MOVE KNET-DED-BALAMT-GTN TO WS-KNET-DED-GTN-HOLD         78391373
               PERFORM 1650-BUILD-DEDUCT-FROM-USAGE                     78391373
               SET KNET-NO-HALVING TO TRUE                              78391373
               MOVE  WS-KNET-DED-GTN-HOLD   TO KNET-DED-TO-TAKE         78391373
           END-IF.                                                      78391373
       5000-EXIT.    EXIT.                                              78391373
                                                                        13091670
       5500-SMS-ELIGIBILITY    SECTION.                                 13091670
           IF (KNET-SMS-PAY-IND = 'Y')                                  15121716
           OR (KNET-SMS-PAY-EXCEPT-IND = 'Y')                           13091670
              IF KNET-EMP-STATUS = 'N'                                  13091670
      *------> Leave W/O Pay NOT eligible for SMS Contribution          13091670
                 MOVE ZEROS TO KNET-AMOUNT                              13091670
              ELSE                                                      13091670
                 MOVE KNET-DED-BALAMT-GTN TO KNET-DED-TO-TAKE           13091670
              END-IF                                                    13091670
           ELSE                                                         13091670
              MOVE ZEROS TO KNET-AMOUNT                                 13091670
           END-IF.                                                      13091670
                                                                        13091670
       5500-EXIT.    EXIT.                                              13091670
                                                                        02312089
       6000-HSA-CALC SECTION.                                           02312089
                                                                        02312089
            MOVE KNET-CHECK-DATE TO XDC3-STD-DATE.                      02312089
            PERFORM XDC3-CONVERT-STD-TO-ISO.                            02312089
            MOVE XDC3-ISO-DATE TO WS-HSA-CHECK-DATE.                    02312089
            MOVE XDC3-ISO-DATE TO WS-HSA-CHECK-DATE-ACTUAL.             02312089
            MOVE '01' TO WS-HSA-CHECK-DATE-DD.                          02312089
            IF ((EMP-HLTH-COVEFFDT <= WS-HSA-CHECK-DATE AND             02312089
               ( HEALTH-COVEND-DATE = XDC3-LOW-ISO-DATE OR              02312089
                 HEALTH-COVEND-DATE >= WS-HSA-CHECK-DATE-ACTUAL) AND    02312089
      *********HLTH-PLAN = 'SP'))                                       14372237
               HLTH-PLAN = 'AP'))                                       14372237
                                                                        EFIX2237
            OR ((EMP-HLTH-COVEFFDT <= WS-HSA-CHECK-DATE) AND            EFIX2314
                (KNET-OLD-HLTH-COVEND-DATE                              EFIX2314
                                   >= WS-HSA-CHECK-DATE-ACTUAL) AND     EFIX2314
                (KNET-OLD-HLTH-PLAN = 'AP'))                            EFIX2314
                                                                        EFIX2314
      ******OR ((EMP-HLTH-COVEFFDT <= WS-HSA-CHECK-DATE AND             EFIX2314
      ******   ( KNET-OLD-HLTH-COVEND-DATE                              EFIX2314
      ******                       >= WS-HSA-CHECK-DATE-ACTUAL) AND     EFIX2314
      ******   KNET-OLD-HLTH-PLAN = 'SP' OR 'AP'))                      EFIX2314
                                                                        EFIX2237
               MOVE KNET-DED-BALAMT-GTN TO KNET-DED-TO-TAKE             02312089
           ELSE                                                         02312089
               MOVE ZEROES TO KNET-DED-TO-TAKE                          02312089
           END-IF.                                                      02312089
       6000-EXIT.    EXIT.                                              02312089
                                                                        02312089
       9000-BEN-STATUS-CHK SECTION.                                     PPNETCLC
                                                                        PPNETCLC
           IF KNET-EMP-STATUS = 'S'                                     PPNETCLC
              IF 2 < 12 * (KNET-END-CCYY  - KNET-SEPARATE-CCYY)         28521025
                        + (KNET-END-MONTH - KNET-SEPARATE-MONTH)        PPNETCLC
                 MOVE 'X' TO LIFE-DEENROLL                              PPNETCLC
                 MOVE 'X' TO ADD-DEENROLL                               PPNETCLC
                 MOVE 'X' TO EPD-DEENROLL                               PPNETCLC
                 MOVE 'X' TO STD-DEENROLL                               13872234
                 MOVE 'X' TO HLTH-DEENROLL                              PPNETCLC
                 MOVE 'X' TO DENTAL-DEENROLL                            PPNETCLC
                 MOVE 'X' TO LEGAL-DEENROLL                             PPNETCLC
                 MOVE 'X' TO DEP-LIFE-DEENROLL                          PPNETCLC
                 MOVE 'X' TO VIS-DEENROLL                               PPNETCLC
              END-IF                                                    PPNETCLC
           END-IF.                                                      PPNETCLC
                                                                        PPNETCLC
       9010-DATE-CONVERSION-DB2 SECTION.                                25991140
                COPY CPPDXDC3.                                          25991140
                                                                        25991140
